!function(){"use strict";function e(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function t(t,n,r,a){if((n||void 0!==t)&&(void 0===t?"undefined":e(t))!==r)throw new Error("Assertion failed: Expected ".concat(null!=a?a:"value"," to be of type ").concat(r," but received ").concat(void 0===t?"undefined":e(t)))}function n(e,t){if(void 0===e)throw new Error("Assertion failed: Expected ".concat(null!=t?t:"value"," to exist but received undefined"))}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,l,"next",e)}function l(e){a(o,r,i,s,l,"throw",e)}s(void 0)}))}}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){s(e,t,n[t])}))}return e}function u(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"localItemName","____sfry_anonymous"),s(this,"sessionId","none"),s(this,"sessionData",{sessionId:"none"}),s(this,"previousLocalStorageData",{sessionId:"n"}),s(this,"currentWallets",new Array),s(this,"currentListenerWallets",new Array),s(this,"SAFARY_BACKEND_ORIGIN",("https://tag.safary.club","https://tag.safary.club")),s(this,"SAFARY_SCRIPT_VERSION",null!=="0.1.16"?"0.1.16":"v0.0.0-dev"),s(this,"SAFARY_TAG",void 0),s(this,"PRODUCT_ID",void 0),s(this,"timeScriptLoaded",(new Date).toISOString()),s(this,"pooling_active",!1),this.SAFARY_TAG=t,this.PRODUCT_ID=this.getProductID()}var a,c,d;return a=e,c=[{key:"setup",value:function(){var e=this;return i((function(){return u(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e.setupSession()];case 1:return t.sent(),e.setupEthereumListeners(),e.setupPhantomSolanaListeners(),e.setupAptosAndAtomListeners(),e.setupWalletConnect(),e.setupOKXWalletListeners(),window.onload=function(){var e=new CustomEvent("fullPageFinishedLoadingSafary");window.dispatchEvent(e)},window.addEventListener("fullPageFinishedLoadingSafary",i((function(){return u(this,(function(t){return e.setupStarknetListeners(),e.setupBitgetWalletListeners(),e.setupSolflareWalletListeners(),e.setupUniSatWalletListeners(),[2]}))}))),e.setupTrackingFunctions(),[3,3];case 2:return t.sent(),console.error("Error during Safary tag setup."),[3,3];case 3:return[2]}}))}))()}},{key:"getProductID",value:function(){var t=this.SAFARY_TAG;if(t||(t=window.document.querySelector('script[data-name="safary-sdk"]')),t){var n=null==t?void 0:t.getAttribute("data-product-id");if(!n){var r=null==t?void 0:t.getAttribute("src");r&&(n=new URL(r).searchParams.get("id"))}if(n&&e.isValidProductID(n))return n}console.error("ERROR: No valid product ID was found. Please contact Safary's support.")}},{key:"getSessionID",value:function(){return this.sessionId}},{key:"getSessionData",value:function(){return this.sessionData}},{key:"setupSession",value:function(){var t=this;return i((function(){var n,r;return u(this,(function(a){switch(a.label){case 0:return null!=(n=window.localStorage.getItem(t.localItemName))&&n.length>0&&(t.previousLocalStorageData=n.startsWith("{")?JSON.parse(n):{sessionId:n},r=t.previousLocalStorageData.sessionId,e.isValidSessionID(r)&&(t.sessionId=r,t.sessionData={sessionId:t.sessionId})),"none"!==t.sessionId?[3,2]:[4,t.getNewSession()];case 1:a.sent(),window.localStorage.setItem(t.localItemName,JSON.stringify(t.sessionData)),a.label=2;case 2:return[2]}}))}))()}},{key:"getNewSession",value:function(){var t=this;return i((function(){return u(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(t.SAFARY_BACKEND_ORIGIN,"/session.json?id=").concat(t.PRODUCT_ID)).then((function(e){if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((function(n){if(!e.isValidSessionID(n.sessionId))throw new Error("Invalid session id");t.sessionData=n,t.sessionId=n.sessionId}))];case 1:return n.sent(),[2]}}))}))()}},{key:"visit",value:function(){var e=this;return i((function(){var t;return u(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,e.processWallet()];case 1:return n.sent(),t=e.getInfoObject("vt"),[4,e.sendVisitData(t)];case 2:return n.sent(),[3,4];case 3:return n.sent(),console.error("Error during Safary tag execution."),[3,4];case 4:return[2]}}))}))()}},{key:"setupTrackingFunctions",value:function(){void 0===window.safary?(window.safary=window.safary||{},window.safary.track=this.track.bind(this),window.safary.trackSwap=this.trackSwaps.bind(this),window.safary.trackSwapConnect=this.trackSwapConnect.bind(this),window.safary.trackDeposit=this.trackDeposit.bind(this),window.safary.trackWithdrawal=this.trackWithdrawal.bind(this),window.safary.trackNFTPurchase=this.trackNFTPurchase.bind(this),window.safary.products=[this.PRODUCT_ID]):window.safary.products.includes(this.PRODUCT_ID)||window.safary.products.push(this.PRODUCT_ID)}},{key:"track",value:function(r){var a=this;return i((function(){var i,o,s,l,c,d,h,v;return u(this,(function(u){switch(u.label){case 0:try{t(r,!0,"object","params"),n(r.eventType,"eventType"),n(r.eventName,"eventName"),t(r.parameters,!1,"object","parameters")}catch(e){return console.error("ERROR: safary.track(): there were some validation errors."),[2]}i=a.getInfoObject("trk",{"trk-type":r.eventType,"trk-name":r.eventName,"trk-param":r.parameters}),o=!0,s=!1,l=void 0,u.label=1;case 1:u.trys.push([1,6,7,8]),c=window.safary.products[Symbol.iterator](),u.label=2;case 2:return(o=(d=c.next()).done)?[3,5]:(h=d.value,e.isValidProductID(h)?(i.tag=h,i.fulltag=void 0,[4,a.sendVisitData(i)]):[3,4]);case 3:u.sent(),u.label=4;case 4:return o=!0,[3,2];case 5:return[3,8];case 6:return v=u.sent(),s=!0,l=v,[3,8];case 7:try{o||null==c.return||c.return()}finally{if(s)throw l}return[7];case 8:return[2]}}))}))()}},{key:"getInfoObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"vt",t=arguments.length>1?arguments[1]:void 0,n=this.isEmptyOrValidStart(window.location.href,!1),r=this.isEmptyOrValidStart(window.document.referrer,!0),a={};if(this.SAFARY_TAG&&Array.from(this.SAFARY_TAG.attributes).forEach((function(e){a[e.name]=e.value})),n&&r)return{si:this.sessionId,pls:this.previousLocalStorageData.sessionId,sd:this.sessionData,plsd:this.previousLocalStorageData,u:window.location.href,r:window.document.referrer,tag:this.PRODUCT_ID,fulltag:Object.keys(a).length>0?a:void 0,wa:this.currentWallets.length>0?this.currentWallets:void 0,evt:e,"evt-trk":null!=t?t:null,v:this.SAFARY_SCRIPT_VERSION,time:"vt"==e?this.timeScriptLoaded:(new Date).toISOString()};throw console.error("ERROR in Safary tag: Invalid URL or Referrer."),new Error("Invalid URL or Referrer. URL: ".concat(window.location.href," Referrer: ").concat(window.document.referrer))}},{key:"isEmptyOrValidStart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return null==e?t:"string"==typeof e&&(!(!t||0!==e.length)||/^[A-Za-z0-9]/.test(e))}},{key:"sendVisitData",value:function(e){var t=this;return i((function(){var n;return u(this,(function(r){return void 0===e.tag?(console.error("ERROR: No valid product ID was found. Please contact Safary's support."),[2]):(n="".concat(t.SAFARY_BACKEND_ORIGIN,"/sfry/?id=").concat(e.tag),[2,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({v:e})})])}))}))()}},{key:"setWalletType",value:function(e){var t,n={isBraveWallet:"Brave",isBitKeep:"Bitget",isPhantom:"Phantom",isCoinbaseWallet:"Coinbase",isMetaMask:"MetaMask"};for(t in n)if(e[t])return n[t];return"Unknown"}},{key:"addWalletFromProvider",value:function(e){var t=this;return i((function(){var n,r,a;return u(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),e&&(null==e?void 0:e.selectedAddress)?null===(n=null==e?void 0:e.chainId)||void 0===n?[3,1]:(a=n,[3,3]):[3,4];case 1:return[4,null==e?void 0:e.request({method:"eth_chainId"})];case 2:a=i.sent(),i.label=3;case 3:return r=a,[2,[null==e?void 0:e.selectedAddress,t.setWalletType(e),r,"eth_sfry_all"]];case 4:return[3,6];case 5:return i.sent(),console.error("Error in Safary tag when adding Wallet From Provider."),[3,6];case 6:return[2,[]]}}))}))()}},{key:"getEthereumProvider",value:function(){return void 0===window.phantom?window.ethereum:void 0!==window.ethereum&&void 0!==window.ethereum.detected&&window.ethereum.detected.length>0?window.ethereum.detected[0]:window.phantom.ethereum}},{key:"processWallet",value:function(){var e=this;return i((function(){var t,n,a,i,o,s,l,c,d,h,v,f,p,w,y,m,g,k,b,S,I,_,A;return u(this,(function(u){switch(u.label){case 0:return void 0===window.ethereum?[3,5]:(t=e.getEthereumProvider())?[4,t.request({method:"eth_accounts"})]:[3,3];case 1:return void 0!==(n=u.sent())&&n.length>0?[4,t.request({method:"eth_chainId"})]:[3,3];case 2:a=u.sent(),n.forEach((function(t){e.currentWallets.push({address:t,event:"eth_accounts",type:null,chainId:a})})),u.label=3;case 3:return[4,e.processEthereum()];case 4:(i=u.sent()).length>0&&i.forEach((function(t){t.length>0&&e.currentWallets.push({address:t[0],event:"eth_accounts__eth",type:t[1],chainId:t[2]})})),u.label=5;case 5:return void 0===window.okxwallet?[3,7]:[4,e.getOKXwallets()];case 6:void 0!==(o=u.sent())&&o.length>0&&o.forEach((function(t){e.currentWallets.push({address:t.address,event:"accounts",type:"OKX Wallet",chainId:t.chainId})})),u.label=7;case 7:if(void 0===window.bitkeep)return[3,28];if(s=[],void 0===window.bitkeep.unisat)return[3,11];u.label=8;case 8:return void 0!==window.bitkeep.unisat._initialized&&window.bitkeep.unisat._initialized?[3,10]:[4,new Promise((function(e){return setTimeout(e,5)}))];case 9:return u.sent(),[3,8];case 10:c=window.bitkeep.unisat.identities,(l=s).push.apply(l,function(e){if(Array.isArray(e))return r(e)}(D=c)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(D)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(D)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u.label=11;case 11:if(void 0===window.bitkeep.ton)return[3,15];u.label=12;case 12:return void 0!==window.bitkeep.ton._initialized&&window.bitkeep.ton._initialized?[3,14]:[4,new Promise((function(e){return setTimeout(e,5)}))];case 13:return u.sent(),[3,12];case 14:d=window.bitkeep.ton.identities,h=window.bitkeep.ton.chainId,d.forEach((function(e){s.push({address:e.address,network:"Ton ".concat(h)})})),u.label=15;case 15:if(void 0===window.bitkeep.solana)return[3,19];u.label=16;case 16:return void 0!==window.bitkeep.solana._initialized&&window.bitkeep.solana._initialized?[3,18]:[4,new Promise((function(e){return setTimeout(e,5)}))];case 17:return u.sent(),[3,16];case 18:f=null===(v=window.bitkeep.solana.publicKey)||void 0===v?void 0:v.toString(),p=window.bitkeep.solana.network,void 0!==f&&""!==f.trim()&&s.push({address:f,network:"Solana ".concat(p)}),u.label=19;case 19:if(void 0===window.bitkeep.aptos)return[3,23];u.label=20;case 20:return void 0!==window.bitkeep.aptos._initialized&&window.bitkeep.aptos._initialized?[3,22]:[4,new Promise((function(e){return setTimeout(e,5)}))];case 21:return u.sent(),[3,20];case 22:void 0!==(w=window.bitkeep.aptos._state)&&""!==w.address.trim()&&s.push({address:w.address,network:"Aptos ".concat(w.network)}),u.label=23;case 23:if(void 0===window.starknet_bitkeep)return[3,27];u.label=24;case 24:return void 0!==window.starknet_bitkeep._initialized&&window.starknet_bitkeep._initialized?[3,26]:[4,new Promise((function(e){return setTimeout(e,5)}))];case 25:return u.sent(),[3,24];case 26:void 0!==(y=window.starknet_bitkeep._state)&&""!==y.address.trim()&&(m=e.getStarknetchainDict(),g=m[y.chainId||""],s.push({address:y.address,network:g})),u.label=27;case 27:void 0!==s&&s.length>0&&s.forEach((function(t){e.currentWallets.push({address:t.address,event:"accounts",type:"Bitget",chainId:t.network})})),u.label=28;case 28:return void 0===window.unisat||void 0!==window.unisat.isBitKeep&&window.unisat.isBitKeep?[3,31]:[4,window.unisat.getAccounts()];case 29:return k=u.sent(),[4,window.unisat.getNetwork()];case 30:S=null!==(b=u.sent())&&void 0!==b?b:"Unknown",void 0!==k&&k.length>0&&k.forEach((function(t){e.currentWallets.push({address:t,event:"accounts",type:"UniSat",chainId:S})})),u.label=31;case 31:return[4,e.handleWalletConnect({key:"SAFARY_VISIT",value:""})];case 32:return(I=u.sent()).length>0&&I.forEach((function(t){null!==t.address&&e.currentWallets.push(t)})),void 0!==window.solflare&&void 0!==(A=null===(_=window.solflare.publicKey)||void 0===_?void 0:_.toString())&&""!==A.trim()&&e.currentWallets.push({address:A,event:"accounts",type:"Solflare",chainId:"Solana"}),[2]}var D}))}))()}},{key:"setupOKXWalletListeners",value:function(){if(void 0!==window.okxwallet){var e=this;window.okxwallet.on("connectWallet",i((function(){var t,n;return u(this,(function(r){switch(r.label){case 0:return[4,e.getOKXwallets()];case 1:return t=r.sent(),n=new Array,void 0!==t&&t.length>0&&t.forEach((function(e){n.push({address:e.address,event:"accountsChanged",type:"OKX Wallet",chainId:e.chainId})})),e.sendWalletData(n),[2]}}))})))}else window.__defineSetter__("okxwallet",this.setupOKXWalletListeners)}},{key:"setupBitgetWalletListeners",value:function(){var e=this;if(void 0!==window.bitkeep){if(void 0!==window.bitkeep.unisat){var t=this;window.bitkeep.unisat.on("accountsChanged",(r=i((function(e){var n,r;return u(this,(function(a){switch(a.label){case 0:return n=new Array,[4,window.bitkeep.unisat.network];case 1:return r=a.sent(),e.forEach((function(e){n.push({address:e,event:"accountsChanged",type:"Bitget",chainId:r})})),t.sendWalletData(n),[2]}}))})),function(e){return r.apply(this,arguments)}));var n=this;window.bitkeep.unisat.on("networkChanged",function(){var e=i((function(e){var t;return u(this,(function(r){return(t=new Array).push({address:"Unknown",event:"accountsChanged",type:"Bitget",chainId:e}),n.sendWalletData(t),[2]}))}));return function(t){return e.apply(this,arguments)}}())}var r;if(void 0!==window.bitkeep.ton){var a=this;window.bitkeep.ton.on("accountsChanged",function(){var e=i((function(e){var t,n;return u(this,(function(r){return t=new Array,n=window.bitkeep.ton.chainId,e.forEach((function(e){t.push({address:e,event:"accountsChanged",type:"Bitget",chainId:"Ton ".concat(n)})})),a.sendWalletData(t),[2]}))}));return function(t){return e.apply(this,arguments)}}());var o=this;window.bitkeep.ton.on("chainChanged",function(){var e=i((function(e){var t;return u(this,(function(n){return(t=new Array).push({address:"Unknown",event:"chainChanged",type:"Bitget",chainId:"Ton ".concat(e)}),o.sendWalletData(t),[2]}))}));return function(t){return e.apply(this,arguments)}}())}if(void 0!==window.bitkeep.solana){var s=this;window.bitkeep.solana.on("connect",function(){var e=i((function(e){var t,n;return u(this,(function(r){return t=new Array,n=window.bitkeep.solana.network,t.push({address:e.toString(),event:"accountsChanged",type:"Bitget",chainId:"Solana ".concat(n)}),s.sendWalletData(t),[2]}))}));return function(t){return e.apply(this,arguments)}}())}if(void 0!==window.bitkeep.aptos){var l=this;window.bitkeep.aptos.onAccountChange(function(){var e=i((function(e){var t,n;return u(this,(function(r){switch(r.label){case 0:return t=new Array,[4,window.bitkeep.aptos.network()];case 1:return n=r.sent(),t.push({address:e.address,event:"accountsChanged",type:"Bitget",chainId:"Aptos ".concat(n)}),l.sendWalletData(t),[2]}}))}));return function(t){return e.apply(this,arguments)}}()),window.bitkeep.aptos.onNetworkChange((function(t){var n=new Array;n.push({address:"Unknown",event:"chainChanged",type:"Bitget",chainId:"Aptos ".concat(t)}),e.sendWalletData(n)}))}if(void 0!==window.starknet_bitkeep){var c=this.getStarknetchainDict(),d=this;window.starknet_bitkeep.on("accountsChanged",function(){var e=i((function(e){var t,n;return u(this,(function(r){return t=new Array,n=c[window.starknet_bitkeep.chainId||""],e.forEach(function(){var e=i((function(e){return u(this,(function(r){return t.push({address:e,event:"accountsChanged",type:"Bitget",chainId:n}),[2]}))}));return function(t){return e.apply(this,arguments)}}()),d.sendWalletData(t),[2]}))}));return function(t){return e.apply(this,arguments)}}());var h=this;window.starknet_argentX.on("networkChanged",function(){var e=i((function(e){var t;return u(this,(function(n){return t=new Array,e.forEach(function(){var e=i((function(e){return u(this,(function(n){return t.push({address:"Unknown",event:"chainChanged",type:"Bitget",chainId:c[e||""]}),[2]}))}));return function(t){return e.apply(this,arguments)}}()),h.sendWalletData(t),[2]}))}));return function(t){return e.apply(this,arguments)}}())}}else window.__defineSetter__("bitkeep",this.setupBitgetWalletListeners)}},{key:"setupSolflareWalletListeners",value:function(){if(void 0!==window.solflare){var e,t=this;window.solflare.on("connect",(e=i((function(e){var n;return u(this,(function(r){return(n=new Array).push({address:e.toString(),event:"accountsChanged",type:"Solflare",chainId:"Solana"}),t.sendWalletData(n),[2]}))})),function(t){return e.apply(this,arguments)}))}else window.__defineSetter__("solflare",this.setupSolflareWalletListeners)}},{key:"setupUniSatWalletListeners",value:function(){var e;if(void 0!==window.unisat){if(void 0===window.unisat.isBitKeep||!window.unisat.isBitKeep){var t=this;window.unisat.on("accountsChanged",(e=i((function(e){var n,r,a;return u(this,(function(i){switch(i.label){case 0:return n=new Array,[4,window.unisat.getNetwork()];case 1:return a=null!==(r=i.sent())&&void 0!==r?r:"Unknown",e.forEach((function(e){n.push({address:e,event:"accountsChanged",type:"UniSat",chainId:a})})),t.sendWalletData(n),[2]}}))})),function(t){return e.apply(this,arguments)}));var n=this;window.unisat.on("networkChanged",function(){var e=i((function(e){var t;return u(this,(function(r){return(t=new Array).push({address:"Unknown",event:"accountsChanged",type:"UniSat",chainId:e}),n.sendWalletData(t),[2]}))}));return function(t){return e.apply(this,arguments)}}())}}else window.__defineSetter__("unisat",this.setupUniSatWalletListeners)}},{key:"getOKXwallets",value:function(){return i((function(){var e,t,n,r,a,i,o,s,l,c,d,h;return u(this,(function(u){switch(u.label){case 0:return e=window.okxwallet.selectedAddress,t=window.okxwallet.chainId,n=[],r=new Set,null!=e&&""!==e.trim()&&(n.push({chainId:t,address:e}),r.add(e)),[4,window.okxwallet.requestWallets()];case 1:if(0===(a=u.sent()).length)return[2,n];i=a[0].address,o=!0,s=!1,l=void 0;try{for(c=i[Symbol.iterator]();!(o=(d=c.next()).done);o=!0)""===(h=d.value).address.trim()||r.has(h.address)||(n.push({chainId:h.chainId,address:h.address}),r.add(h.address))}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}return[2,n]}}))}))()}},{key:"processEthereum",value:function(){var e=this;return i((function(){var t,n,r;return u(this,(function(a){switch(a.label){case 0:return t=[],void 0!==window.ethereum.providers&&window.ethereum.providers.forEach((o=i((function(n){var r;return u(this,(function(a){switch(a.label){case 0:return r=t.push,[4,e.addWalletFromProvider(n)];case 1:return r.apply(t,[a.sent()]),[2]}}))})),function(e){return o.apply(this,arguments)})),void 0===window.ethereum.selectedProvider?[3,2]:(n=t.push,[4,e.addWalletFromProvider(window.ethereum.selectedProvider)]);case 1:return n.apply(t,[a.sent()]),[3,4];case 2:return r=t.push,[4,e.addWalletFromProvider(e.getEthereumProvider())];case 3:r.apply(t,[a.sent()]),a.label=4;case 4:return[2,t]}var o}))}))()}},{key:"setupEthereumListeners",value:function(){if(void 0!==window.ethereum){var e,t=this;window.ethereum.on("accountsChanged",(e=i((function(e){var n,r;return u(this,(function(a){switch(a.label){case 0:return n=new Array,Array.isArray(e)||(e=[e]),[4,window.ethereum.request({method:"eth_chainId"})];case 1:return r=a.sent(),e.forEach(function(){var e=i((function(e){return u(this,(function(t){return n.push({address:e,event:"accountsChanged",type:null,chainId:r}),[2]}))}));return function(t){return e.apply(this,arguments)}}()),[4,t.processEthereum()];case 2:return a.sent().forEach((function(e){null!==e[0]&&void 0!==e[0]&&n.push({address:e[0],event:"eth_accounts__eth_listener",type:e[1],chainId:e[2]})})),t.sendWalletData(n),[2]}}))})),function(t){return e.apply(this,arguments)}));var n=this;window.ethereum.on("chainChanged",function(){var e=i((function(e){var t;return u(this,(function(r){return t=new Array,Array.isArray(e)||(e=[e]),e.forEach(function(){var e=i((function(e){return u(this,(function(n){return t.push({address:"Unknown",event:"chainChanged",type:null,chainId:e}),[2]}))}));return function(t){return e.apply(this,arguments)}}()),n.sendWalletData(t),[2]}))}));return function(t){return e.apply(this,arguments)}}())}else window.__defineSetter__("ethereum",this.setupEthereumListeners)}},{key:"setupPhantomSolanaListeners",value:function(){if(void 0!==window.phantom){var e,t=this;window.phantom.solana.on("connect",(e=i((function(e){var n;return u(this,(function(r){return(n=new Array).push({address:e.toString(),event:"accountsChanged",type:"Phantom",chainId:"Solana"}),t.sendWalletData(n),[2]}))})),function(t){return e.apply(this,arguments)}))}else window.__defineSetter__("phantom",this.setupPhantomSolanaListeners)}},{key:"is_atomscan",value:function(e){return!!e&&["8ball","aaronetwork","acrechain","agoric","aioz","akash","akiro","althea","andromeda","andromeda1","archway","arkh","assetmantle","atomone","aura","aura1","axelar","band","bandchain","bcna","beezee","berachain","bitbadges","bitcanna","bitsong","blockx","bluechip","bluzelle","bostrom","bouachain","bze","c4e","canto","carbon","celestia","cerberus","chain4energy","cheqd","chihuahua","chimba","chronicnetwork","cifer","cifer1","cnhostables","comdex","commercionetwork","composable","conscious","coreum","cosmos","cosmoshub","coss","cre","crescent","cro","cronos","cryptoorgchain","cudos","darc","decentr","desmos","dhealth","dig","doravota","dungeon","dydx","dymension","dyson","echelon","elys","emoney","empowerchain","epix","ethos","evmos","fetch","fetchhub","finschia","firma","firmachain","furya","fxcore","galactica","galaxy","gateway","genesis","genesisl1","gitopia","govgen","gravity","gravitybridge","hall","haqq","heli","highbury","humans","iaa","idep","impacthub","imversed","initia","inj","injective","int3face","irisnet","ixo","jackal","joltify","juno","kava","ki","kichain","kimanetwork","konstellation","kopi","kujira","kyve","lamb","lambda","lava","like","likecoin","logos","loop","lorenzo","loyal","lum","lumen","lumenx","lumnetwork","mande","mantle","mantrachain","mars","mayachain","medasdigital","meme","microtick","migaloo","milkyway","mises","movement","mtgbp","mun","mythos","namada","neura","neutaro","neutron","nibiru","nim","noble","nois","nolus","nomic","nyx","octa","odin","odin1","okexchain","omniflix","omniflixhub","onex","onomy","opct","orai","oraichain","osmo","osmosis","paloma","panacea","pasg","passage","passage1","pb","persistence","planq","plq","point","provenance","pryzm","pundix","pylons","qfs","quasar","quicksilver","qwoyn","realio","rebus","regen","rizon","routerchain","saga","scorum","secret","secretnetwork","seda","sei","self","sent","sentinel","sge","shareledger","shentu","shido","sif","sifchain","six","somm","sommelier","source","stafi","stafihub","star","stargaze","starname","stars","stratos","stride","sunrise","swth","synternet","taketitan","tenet","teritori","terpnetwork","terra","terra2","testnets","tgrade","thorchain","titan","tori","umee","und","unicorn","unification","ununifi","uptick","vdl","vector","vidulum","wardenprotocol","xion","xpla","zenrock","zetachain"].some((function(t){return e.startsWith(t)}))}},{key:"setupAptosAndAtomListeners",value:function(){var e=this;window.addEventListener("message",(function(t){var n,r,a,i,o,s,l,u,c,d,h,v;if("FuelConnectorScript"===(null==t||null===(n=t.data)||void 0===n?void 0:n.target)&&"response"===(null==t||null===(r=t.data)||void 0===r?void 0:r.type)){var f,p,w=null==t||null===(p=t.data)||void 0===p||null===(f=p.response)||void 0===f?void 0:f.result;if("boolean"==typeof w)return;var y=new Array;if("string"==typeof w&&(w.startsWith("0x")||w.startsWith("fuel")))y.push({address:w,event:"accountsChanged",type:w.startsWith("fuel")?"Fuelet":"Fuel",chainId:null});else{var m,g,k,b=null==t||null===(k=t.data)||void 0===k||null===(g=k.response)||void 0===g||null===(m=g.result)||void 0===m?void 0:m.chainId;if(void 0!==b)y.push({address:"Unknown",event:"chainChanged",type:"Fuel",chainId:b});else{var S,I,_,A=null==t||null===(_=t.data)||void 0===_||null===(I=_.response)||void 0===I||null===(S=I.result)||void 0===S?void 0:S.url;"string"==typeof A&&(A.includes("mainnet.fuel.network")?y.push({address:"Unknown",event:"chainChanged",type:"Fuelet",chainId:9889}):A.includes("testnet.fuel.network")&&y.push({address:"Unknown",event:"chainChanged",type:"Fuelet",chainId:0}))}}e.sendWalletData(y)}else if("PetraApiResponse"===(null==t||null===(a=t.data)||void 0===a?void 0:a.type)){var D,C,W,E,O,R,P=new Array;if(null==t||null===(C=t.data)||void 0===C||null===(D=C.result)||void 0===D?void 0:D.chainId)P.push({address:"Unknown",event:"chainChanged",type:"Petra",chainId:"Aptos ".concat(null==t||null===(R=t.data)||void 0===R||null===(O=R.result)||void 0===O?void 0:O.name)});else if(null==t||null===(E=t.data)||void 0===E||null===(W=E.result)||void 0===W?void 0:W.address){var N,L;P.push({address:null==t||null===(L=t.data)||void 0===L||null===(N=L.result)||void 0===N?void 0:N.address,event:"accountsChanged",type:"Petra",chainId:null})}e.sendWalletData(P)}else if("proxy-request"===(null==t||null===(i=t.data)||void 0===i?void 0:i.type)&&"getKey"===(null==t||null===(o=t.data)||void 0===o?void 0:o.method)){var T,x=null==t||null===(T=t.data)||void 0===T?void 0:T.args[0];e.is_atomscan(x)&&((P=new Array).push({address:"Unknown",event:"chainChanged",type:"Keplr",chainId:x}),e.sendWalletData(P))}else if("proxy-request-response"===(null==t||null===(s=t.data)||void 0===s?void 0:s.type)){var U,j,F,B=null==t||null===(F=t.data)||void 0===F||null===(j=F.result)||void 0===j||null===(U=j.return)||void 0===U?void 0:U.bech32Address;e.is_atomscan(B)&&((P=new Array).push({address:B,event:"accountsChanged",type:"Keplr",chainId:null}),e.sendWalletData(P))}else if("leap:content"===(null==t||null===(l=t.data)||void 0===l?void 0:l.target)&&"enable-access"===(null==t||null===(c=t.data)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.type)){var V,K;x=null==t||null===(K=t.data)||void 0===K||null===(V=K.data)||void 0===V?void 0:V.chainIds[0],e.is_atomscan(x)&&((P=new Array).push({address:"Unknown",event:"chainChanged",type:"Leap",chainId:x}),e.sendWalletData(P))}else if("leap:inpage"===(null==t||null===(d=t.data)||void 0===d?void 0:d.target)&&"onGET-KEY"===(null===(v=t.data)||void 0===v||null===(h=v.data)||void 0===h?void 0:h.name)){var z,G,q,X;B=null==t||null===(X=t.data)||void 0===X||null===(q=X.data)||void 0===q||null===(G=q.payload)||void 0===G||null===(z=G.key)||void 0===z?void 0:z.bech32Address,e.is_atomscan(B)&&((P=new Array).push({address:B,event:"accountsChanged",type:"Leap",chainId:null}),e.sendWalletData(P))}})),void 0!==window.aptos&&(window.aptos.onAccountChange((function(t){var n=new Array;n.push({address:null==t?void 0:t.address,event:"accountsChanged",type:"Petra",chainId:null}),e.sendWalletData(n)})),window.aptos.onNetworkChange((function(t){var n=new Array;n.push({address:"Unknown",event:"accountsChanged",type:"Petra",chainId:"Aptos ".concat(null==t?void 0:t.name)}),e.sendWalletData(n)})))}},{key:"setupStarknetListeners",value:function(){var e,t=this.getStarknetchainDict();if(void 0!==window.starknet_argentX){var n=this;window.starknet_argentX.on("accountsChanged",(e=i((function(e){var r,a,o;return u(this,(function(s){return r=new Array,Array.isArray(e)||(e=[e]),a=window.starknet_argentX.name,o=t[window.starknet_argentX.chainId||""],e.forEach(function(){var e=i((function(e){return u(this,(function(t){return r.push({address:e,event:"accountsChanged",type:a,chainId:o}),[2]}))}));return function(t){return e.apply(this,arguments)}}()),n.sendWalletData(r),[2]}))})),function(t){return e.apply(this,arguments)}));var r=this;window.starknet_argentX.on("networkChanged",function(){var e=i((function(e){var n,a;return u(this,(function(o){return n=new Array,Array.isArray(e)||(e=[e]),a=window.starknet_argentX.name,e.forEach(function(){var e=i((function(e){return u(this,(function(r){return n.push({address:"Unknown",event:"chainChanged",type:a,chainId:t[e||""]}),[2]}))}));return function(t){return e.apply(this,arguments)}}()),r.sendWalletData(n),[2]}))}));return function(t){return e.apply(this,arguments)}}())}if(void 0!==window.starknet_braavos){Object.defineProperty(window.starknet_braavos,"selectedAddress",{get:function(){return this._selectedAddress},set:function(e){if(""!==e&&null!=e){var n=t[window.starknet_braavos.account.provider.chainId||""],r=new CustomEvent("customConnectedWalletSafary",{detail:{wallet:{address:e,event:"accountsChanged",type:"Braavos",chainId:n}}});window.dispatchEvent(r)}this._selectedAddress=e},configurable:!0,enumerable:!0});var a=this;window.addEventListener("customConnectedWalletSafary",function(){var e=i((function(e){return u(this,(function(t){switch(t.label){case 0:return[4,a.sendWalletData([e.detail.wallet])];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())}}},{key:"setupWalletConnect",value:function(){try{var e=window.localStorage.setItem;window.localStorage.setItem=function(t,n){try{e.call(this,t,n);var r=new CustomEvent("localStorageSetItem",{detail:{key:t,value:n}});window.dispatchEvent(r)}catch(e){console.error("Error in Safary tag when saving Local Storage.")}};var t=this;window.addEventListener("localStorageSetItem",(n=i((function(e){var n,r,a,i,o,s,l,c;return u(this,(function(u){switch(u.label){case 0:return["wagmi.store"].includes(e.detail.key)?(n=t.handleWagmi(e.detail.value),[4,t.sendWalletData(n)]):[3,2];case 1:return u.sent(),[3,17];case 2:return["hashconnectData"].includes(e.detail.key)?(r=t.handleHashConnect(e.detail.value),[4,t.sendWalletData(r)]):[3,4];case 3:return u.sent(),[3,17];case 4:return["li.fi-wallets"].includes(e.detail.key)?(a=t.handleLiFi(e.detail.value),[4,t.sendWalletData(a)]):[3,6];case 5:return u.sent(),[3,17];case 6:return e.detail.key.startsWith("dynamic_authenticated_user")?(i=t.handleDynamic(e.detail.value),[4,t.sendWalletData(i)]):[3,8];case 7:return u.sent(),[3,17];case 8:return e.detail.key.startsWith("dynamic_store")?(o=t.handleDynamic(e.detail.value),[4,t.sendWalletData(o)]):[3,10];case 9:return u.sent(),[3,17];case 10:return["privy:connections"].includes(e.detail.key)?(s=t.handlePrivy(e.detail.value),[4,t.sendWalletData(s)]):[3,12];case 11:return u.sent(),[3,17];case 12:return["ajs_user_traits"].includes(e.detail.key)?(l=t.handleMagicLink(e.detail.value),[4,t.sendWalletData(l)]):[3,14];case 13:return u.sent(),[3,17];case 14:return[4,t.handleWalletConnect(e.detail,!0)];case 15:return c=u.sent(),[4,t.sendWalletData(c)];case 16:u.sent(),u.label=17;case 17:return[2]}}))})),function(e){return n.apply(this,arguments)}))}catch(e){console.error("Error in Safary tag when setting up Wallet Connect.")}var n}},{key:"sendWalletData",value:function(t){var n=this;return i((function(){var r,a;return u(this,(function(i){switch(i.label){case 0:return t.length>0&&(r=e.filterExistingObjects(t,n.currentListenerWallets)).length>0?(n.currentListenerWallets=n.currentListenerWallets.concat(r),(a=n.getInfoObject("wl")).wa=r,[4,n.sendVisitData(a)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))()}},{key:"handleWagmi",value:function(e){try{var t,n,r=JSON.parse(e);if(r&&(null==r||null===(t=r.state)||void 0===t?void 0:t.data)){var a,i=null==r||null===(a=r.state)||void 0===a?void 0:a.data;if(i&&i.account&&i.account.length>0){var o,s=null;try{s=JSON.parse(window.localStorage.getItem("wagmi.wallet")||"")}catch(e){s=null}return[{address:i.account,event:"wagmi_wallets",type:s,chainId:null==i||null===(o=i.chain)||void 0===o?void 0:o.id}]}}else if(r&&(null==r||null===(n=r.state)||void 0===n?void 0:n.connections)){var l,u,c=null==r||null===(u=r.state)||void 0===u||null===(l=u.connections)||void 0===l?void 0:l.value;if(c&&c.length>0){var d=new Array,h=!0,v=!1,f=void 0;try{for(var p,w=c[Symbol.iterator]();!(h=(p=w.next()).done);h=!0){var y,m=p.value;m.length>1&&m[1].accounts.length>0&&d.push({address:m[1].accounts[0],event:"wagmi_wallets",type:null===(y=m[1].connector)||void 0===y?void 0:y.name,chainId:m[1].chainId})}}catch(e){v=!0,f=e}finally{try{h||null==w.return||w.return()}finally{if(v)throw f}}return d}}}catch(e){return[]}return[]}},{key:"handleHashConnect",value:function(e){var t=this.getHederachainDict(),n=new Array;try{var r,a=JSON.parse(e);if(a&&(null==a?void 0:a.pairingData)&&(null==a||null===(r=a.pairingData)||void 0===r?void 0:r.length)>0){var i=null==a?void 0:a.pairingData,o=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d,h=u.value,v=t["hedera-"+(null==h?void 0:h.network)];if(h&&(null==h?void 0:h.accountIds)&&(null==h||null===(d=h.accountIds)||void 0===d?void 0:d.length)>0){var f=!0,p=!1,w=void 0;try{for(var y,m=h.accountIds[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value;n.push({address:g,event:"hashconnect_wallets",type:"HashPack",chainId:v})}}catch(e){p=!0,w=e}finally{try{f||null==m.return||m.return()}finally{if(p)throw w}}}}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}}}catch(e){return n}return n}},{key:"handleLiFi",value:function(e){try{var t=JSON.parse(e);if(t&&t.length>0){var n=t[t.length-1];if(n&&(null==n?void 0:n.address)&&(null==n?void 0:n.address.length)>0)return[{address:n.address,event:"lifi_wallets",type:n.name,chainId:null}]}}catch(e){return[]}return[]}},{key:"handleDynamic",value:function(e){var t=new Array;try{var n,r,a=JSON.parse(e);if(void 0!==(null==a||null===(n=a.state)||void 0===n?void 0:n.user)&&(a=a.state.user),a&&(null==a?void 0:a.verifiedCredentials)&&(null==a||null===(r=a.verifiedCredentials)||void 0===r?void 0:r.length)>0){var i=null==a?void 0:a.verifiedCredentials,o=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d,h=u.value;h&&(null==h?void 0:h.address)&&(null==h||null===(d=h.address)||void 0===d?void 0:d.length)>0&&t.push({address:h.address,event:"dynamic_authenticated_user",type:h.walletName,chainId:h.chain})}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}}}catch(e){return t}return t}},{key:"handlePrivy",value:function(e){var t=new Array;try{var n=JSON.parse(e);if(n&&(null==n?void 0:n.length)>0){var r=n,a=!0,i=!1,o=void 0;try{for(var s,l=r[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var u,c=s.value;c&&(null==c?void 0:c.address)&&(null==c||null===(u=c.address)||void 0===u?void 0:u.length)>0&&t.push({address:c.address,event:"privy_connection",type:"unknown"!==c.walletClientType?c.walletClientType:c.connectorType,chainId:null==c?void 0:c.chainId})}}catch(e){i=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}}}catch(e){return t}return t}},{key:"handleMagicLink",value:function(e){var t=new Array;try{var n=JSON.parse(e);void 0!==(null==n?void 0:n.ethAddress)&&t.push({address:n.ethAddress,event:"magiclink_wallets",type:"Magic.link",chainId:null})}catch(e){return t}return t}},{key:"handleWalletConnect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return i((function(){var r,a,i,o,s,l;return u(this,(function(u){switch(u.label){case 0:return r=e.key,["wc@2:client:0.3//session","WALLETCONNECT_DEEPLINK_CHOICE","wc@2:ethereum_provider:/chainId","WCM_RECENT_WALLET_DATA","WCM_VERSION","SAFARY_VISIT","SAFARY_POOLING"].includes(r)?(a=window.localStorage.getItem("wc@2:client:0.3//session"))&&(null==a?void 0:a.length)>0?[4,n.processWalletConnect(t,a)]:[3,2]:[3,10];case 1:case 6:return[2,u.sent()];case 2:return u.trys.push([2,9,,10]),[4,n.getValueFromIndexedDB("wc@2:client:0.3:session")];case 3:return(i=u.sent())&&(null==i?void 0:i.length)>0?[4,n.getValueFromIndexedDB("WALLETCONNECT_DEEPLINK_CHOICE")]:[3,7];case 4:return o=u.sent(),[4,n.getValueFromIndexedDB("wc@2:ethereum_provider:chainId")];case 5:return s=u.sent(),[4,n.processWalletConnect(t,i,o,s)];case 7:throw new Error("Error Reading Wallet Connect from IndexedDB.");case 8:return[3,10];case 9:return u.sent(),!1===n.pooling_active&&(l=window.setInterval((function(){if(n.pooling_active){var e=new CustomEvent("localStorageSetItem",{detail:{key:"SAFARY_POOLING",value:""}});window.dispatchEvent(e)}}),1e4),window.setTimeout((function(){window.clearInterval(l),n.pooling_active=!1}),6e4),n.pooling_active=!0),[3,10];case 10:return[2,[]]}}))}))()}},{key:"getHederachainDict",value:function(){return{"hedera-mainnet":295,"hedera-testnet":296,"hedera-previewnet":297,"hedera-localnet":298}}},{key:"getStarknetchainDict",value:function(){return{SN_MAIN:"Starknet Mainnet","0x534e5f4d41494e":"Starknet Mainnet","23448594291968334":"Starknet Mainnet","393402133025997798000961":"Starknet Sepolia","0x534e5f5345504f4c4941":"Starknet Sepolia",SN_SEPOLIA:"Starknet Sepolia","1536727068981429685321":"Starknet Goerli","0x534e5f474f45524c49":"Starknet Goerli",SN_GOERLI:"Starknet Goerli","393402129659245999442226":"Starknet Goerli2","0x534e5f474f45524c4932":"Starknet Goerli2",SN_GOERLI2:"Starknet Goerli2","":"Unknown"}}},{key:"getValueFromIndexedDB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"WALLET_CONNECT_V2_INDEXED_DB",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"keyvaluestorage";return i((function(){var r;return u(this,(function(a){return r=!1,[2,new Promise((function(a,i){var o=window.indexedDB.open(t);o.onerror=function(e){r?a(null):(console.error("Safary tag error: IndexedDB Database error."),i(o.error))},o.onupgradeneeded=function(){var e;r=!0,null==o||null===(e=o.transaction)||void 0===e||e.abort(),a(null)},o.onsuccess=function(t){var r=o.result;try{var s=r.transaction([n],"readonly").objectStore(n).get(e);s.onerror=function(e){console.error("Safary tag error: IndexedDB Error getting value."),i(s.error)},s.onsuccess=function(e){a(s.result)}}catch(e){a(null)}}}))]}))}))()}},{key:"processWalletConnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.localStorage.getItem("wc@2:client:0.3//session"),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.localStorage.getItem("WALLETCONNECT_DEEPLINK_CHOICE"),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.localStorage.getItem("wc@2:ethereum_provider:/chainId"),a=this;return i((function(){var i,o,s,l,c,d,h,v,f,p;return u(this,(function(u){i=new Array;try{if(t){if(!(o=JSON.parse(t||"")[0])||!o.namespaces)return[2,[]];s=o.namespaces,l=s[Object.keys(s)[0]],c=l.accounts[0].split(":"),d=c.pop(),h=c.join("-"),v=a.getHederachainDict(),f=h.startsWith("hedera")?v[h]:r,p=a.getWalletTypeForWalletConnect(n,o),i.push({address:d,event:e?"eth_sfry_wc_listener":"eth_sfry_wc",type:p,chainId:f}),a.pooling_active=!1}}catch(e){console.error("Safary tag error when processing Wallet Connect.",e)}return[2,i]}))}))()}},{key:"getWalletTypeForWalletConnect",value:function(e,t){var n=void 0;try{var r,a,i;e&&e.trim().length>0&&(n=null===(r=JSON.parse(e))||void 0===r?void 0:r.name),n&&0!==n.trim().length||(n=(null==t||null===(i=t.peer)||void 0===i||null===(a=i.metadata)||void 0===a?void 0:a.name)||"WalletConnect")}catch(e){}return null!=n?n:"WalletConnect"}},{key:"trackSwaps",value:function(e){var r=this;return i((function(){var a;return u(this,(function(i){try{t(e,!0,"object","params"),n(null==e?void 0:e.fromAmount,"fromAmount"),n(null==e?void 0:e.fromCurrency,"fromCurrency"),n(null==e?void 0:e.contractAddress,"contractAddress"),t(null==e?void 0:e.parameters,!1,"object","parameters")}catch(e){return console.error("ERROR: safary.trackSwaps(): there were some validation errors."),[2]}return[2,r.track({eventType:"swap",eventName:null!==(a=null==e?void 0:e.eventName)&&void 0!==a?a:"Swaps",parameters:{default__fromAmount:null==e?void 0:e.fromAmount,default__fromCurrency:null==e?void 0:e.fromCurrency,default__contractAddress:null==e?void 0:e.contractAddress,default__fromAmountUSD:null==e?void 0:e.fromAmountUSD}})]}))}))()}},{key:"trackSwapConnect",value:function(e){var r=this;return i((function(){var a,i,o,s;return u(this,(function(u){switch(u.label){case 0:try{if(t(e,!0,"object","params"),n(null==e?void 0:e.fromWalletAddress,"fromWalletAddress"),n(null==e?void 0:e.toWalletAddress,"toWalletAddress"),t(null==e?void 0:e.parameters,!1,"object","parameters"),Object.keys((null==e?void 0:e.parameters)||{}).some((function(e){return["fromAmount","fromCurrency","fromAmountUSD","fromWalletAddress","fromChain","toAmount","toCurrency","toAmountUSD","toWalletAddress","toChain"].includes(e)})))throw new Error}catch(e){return console.error("ERROR: safary.trackSwapConnect(): there were some validation errors."),[2]}return[4,r.track({eventType:"click",eventName:null!==(a=null==e?void 0:e.eventName)&&void 0!==a?a:"Swap Request",parameters:l({fromAmount:null==e?void 0:e.fromAmount,fromCurrency:null==e?void 0:e.fromCurrency,fromAmountUSD:null==e?void 0:e.fromAmountUSD,fromWalletAddress:null==e?void 0:e.fromWalletAddress,fromChain:null==e?void 0:e.fromChain,toAmount:null==e?void 0:e.toAmount,toCurrency:null==e?void 0:e.toCurrency,toAmountUSD:null==e?void 0:e.toAmountUSD,toWalletAddress:null==e?void 0:e.toWalletAddress,toChain:null==e?void 0:e.toChain},null==e?void 0:e.parameters)})];case 1:return u.sent(),i=new Array,(null==e?void 0:e.fromWalletAddress)&&i.push({address:null==e?void 0:e.fromWalletAddress,event:"swap_connected",type:"Unknown",chainId:null!==(o=null==e?void 0:e.fromChain)&&void 0!==o?o:null}),(null==e?void 0:e.toWalletAddress)&&i.push({address:null==e?void 0:e.toWalletAddress,event:"swap_connected",type:"Unknown",chainId:null!==(s=null==e?void 0:e.toChain)&&void 0!==s?s:null}),[4,r.sendWalletData(i)];case 2:return u.sent(),[2]}}))}))()}},{key:"trackDeposit",value:function(e){var r=this;return i((function(){var a;return u(this,(function(i){try{t(e,!0,"object","params"),n(null==e?void 0:e.amount,"fromAmount"),n(null==e?void 0:e.currency,"fromCurrency"),n(null==e?void 0:e.contractAddress,"contractAddress"),t(null==e?void 0:e.parameters,!1,"object","parameters")}catch(e){return console.error("ERROR: safary.trackDeposit(): there were some validation errors."),[2]}return[2,r.track({eventType:"deposit",eventName:null!==(a=null==e?void 0:e.eventName)&&void 0!==a?a:"Deposits",parameters:{default__fromAmount:null==e?void 0:e.amount,default__fromCurrency:null==e?void 0:e.currency,default__contractAddress:null==e?void 0:e.contractAddress,default__fromAmountUSD:null==e?void 0:e.amountUSD}})]}))}))()}},{key:"trackWithdrawal",value:function(e){var r=this;return i((function(){var a;return u(this,(function(i){try{t(e,!0,"object","params"),n(null==e?void 0:e.amount,"fromAmount"),n(null==e?void 0:e.currency,"fromCurrency"),n(null==e?void 0:e.contractAddress,"contractAddress"),t(null==e?void 0:e.parameters,!1,"object","parameters")}catch(e){return console.error("ERROR: safary.trackWithdrawal(): there were some validation errors."),[2]}return[2,r.track({eventType:"withdrawal",eventName:null!==(a=null==e?void 0:e.eventName)&&void 0!==a?a:"Withdrawals",parameters:{default__fromAmount:null==e?void 0:e.amount,default__fromCurrency:null==e?void 0:e.currency,default__contractAddress:null==e?void 0:e.contractAddress,default__fromAmountUSD:null==e?void 0:e.amountUSD}})]}))}))()}},{key:"trackNFTPurchase",value:function(e){var r=this;return i((function(){var a;return u(this,(function(i){try{t(e,!0,"object","params"),n(null==e?void 0:e.amount,"fromAmount"),n(null==e?void 0:e.currency,"fromCurrency"),n(null==e?void 0:e.contractAddress,"contractAddress"),n(null==e?void 0:e.tokenId,"tokenId"),t(null==e?void 0:e.parameters,!1,"object","parameters")}catch(e){return console.error("ERROR: safary.trackNFTPurchase(): there were some validation errors."),[2]}return[2,r.track({eventType:"NFT Purchase",eventName:null!==(a=null==e?void 0:e.eventName)&&void 0!==a?a:"NFT Purchases",parameters:{default__fromAmount:null==e?void 0:e.amount,default__fromCurrency:null==e?void 0:e.currency,default__fromAmountUSD:null==e?void 0:e.amountUSD,default__contractAddress:null==e?void 0:e.contractAddress,default__tokenId:null==e?void 0:e.tokenId}})]}))}))()}}],d=[{key:"isValidProductID",value:function(e){return"string"!=typeof e?(console.error("ERROR: safary.isValidProductID(): the product ID must be a string."),!1):14!==e.length?(console.error("ERROR: safary.isValidProductID(): the product ID must have 14 characters."),!1):e.startsWith("prd_")?!!/^[a-z0-9]+$/i.test(e.substring(4))||(console.error("ERROR: safary.isValidProductID(): the product ID must be alphanumeric."),!1):(console.error('ERROR: safary.isValidProductID(): the product ID must start with "prd_".'),!1)}},{key:"isValidSessionID",value:function(e){return"string"!=typeof e?(console.error("ERROR: safary.isValidSessionID(): the session ID must be a string."),!1):36!==e.length?(console.error("ERROR: safary.isValidSessionID(): the session ID must have 36 characters."),!1):!!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||(console.error("ERROR: safary.isValidSessionID(): the session ID must be a valid UUID."),!1)}},{key:"isObjectInList",value:function(e,t){return t.some((function(t){return t.address===e.address&&t.event===e.event&&t.type===e.type&&t.chainId===e.chainId}))}},{key:"filterExistingObjects",value:function(t,n){return t.filter((function(t){return!e.isObjectInList(t,n)}))}}],c&&o(a.prototype,c),d&&o(a,d),e}();function d(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}var h=window.document.currentScript;function v(){var e;return e=function(){var e;return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(t){switch(t.label){case 0:return[4,(e=new c(h)).setup()];case 1:return t.sent(),[4,e.visit()];case 2:return t.sent(),[2]}}))},v=function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){d(i,r,a,o,s,"next",e)}function s(e){d(i,r,a,o,s,"throw",e)}o(void 0)}))},v.apply(this,arguments)}"undefined"!=typeof window&&function(){v.apply(this,arguments)}()}();
