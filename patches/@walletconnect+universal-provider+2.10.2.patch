diff --git a/node_modules/@walletconnect/universal-provider/dist/index.cjs.js b/node_modules/@walletconnect/universal-provider/dist/index.cjs.js
index d4fc0f5..7384e91 100644
--- a/node_modules/@walletconnect/universal-provider/dist/index.cjs.js
+++ b/node_modules/@walletconnect/universal-provider/dist/index.cjs.js
@@ -24,5 +24,5 @@ __p += '`),H&&(m+=`' +
 function print() { __p += __j.call(arguments, '') }
 `:`;
 `)+m+`return __p
-}`;var b=_a(function(){return U(o,I+"return "+m).apply(i,f)});if(b.source=m,Ei(b))throw b;return b}function $d(n){return q(n).toLowerCase()}function Ud(n){return q(n).toUpperCase()}function qd(n,t,e){if(n=q(n),n&&(e||t===i))return ys(n);if(!n||!(t=pn(t)))return n;var r=On(n),s=On(t),o=Ss(r,s),f=Rs(r,s)+1;return at(r,o,f).join("")}function Wd(n,t,e){if(n=q(n),n&&(e||t===i))return n.slice(0,bs(n)+1);if(!n||!(t=pn(t)))return n;var r=On(n),s=Rs(r,On(t))+1;return at(r,0,s).join("")}function Fd(n,t,e){if(n=q(n),n&&(e||t===i))return n.replace(Er,"");if(!n||!(t=pn(t)))return n;var r=On(n),s=Ss(r,On(t));return at(r,s).join("")}function Md(n,t){var e=La,r=Da;if(z(t)){var s="separator"in t?t.separator:s;e="length"in t?O(t.length):e,r="omission"in t?pn(t.omission):r}n=q(n);var o=n.length;if(Dt(n)){var f=On(n);o=f.length}if(e>=o)return n;var c=e-Nt(r);if(c<1)return r;var l=f?at(f,0,c).join(""):n.slice(0,c);if(s===i)return l+r;if(f&&(c+=l.length-c),yi(s)){if(n.slice(c).search(s)){var v,_=l;for(s.global||(s=Br(s.source,q(Zi.exec(s))+"g")),s.lastIndex=0;v=s.exec(_);)var m=v.index;l=l.slice(0,m===i?c:m)}}else if(n.indexOf(pn(s),c)!=c){var P=l.lastIndexOf(s);P>-1&&(l=l.slice(0,P))}return l+r}function Bd(n){return n=q(n),n&&Va.test(n)?n.replace(zi,_f):n}var Gd=Mt(function(n,t,e){return n+(e?" ":"")+t.toUpperCase()}),Oi=mu("toUpperCase");function va(n,t,e){return n=q(n),t=e?i:t,t===i?lf(n)?Pf(n):ef(n):n.match(t)||[]}var _a=L(function(n,t){try{return hn(n,i,t)}catch(e){return Ei(e)?e:new S(e)}}),Kd=Yn(function(n,t){return wn(t,function(e){e=Wn(e),zn(n,e,Ii(n[e],n))}),n});function zd(n){var t=n==null?0:n.length,e=x();return n=t?G(n,function(r){if(typeof r[1]!="function")throw new Pn($);return[e(r[0]),r[1]]}):[],L(function(r){for(var s=-1;++s<t;){var o=n[s];if(hn(o[0],this,r))return hn(o[1],this,r)}})}function Jd(n){return _c(Cn(n,Dn))}function bi(n){return function(){return n}}function Yd(n,t){return n==null||n!==n?t:n}var Zd=Pu(),Xd=Pu(!0);function cn(n){return n}function Ti(n){return Qs(typeof n=="function"?n:Cn(n,Dn))}function Qd(n){return ks(Cn(n,Dn))}function Vd(n,t){return js(n,Cn(t,Dn))}var kd=L(function(n,t){return function(e){return oe(e,n,t)}}),jd=L(function(n,t){return function(e){return oe(n,e,t)}});function Li(n,t,e){var r=V(t),s=Ke(t,r);e==null&&!(z(t)&&(s.length||!r.length))&&(e=t,t=n,n=this,s=Ke(t,V(t)));var o=!(z(e)&&"chain"in e)||!!e.chain,f=Xn(n);return wn(s,function(c){var l=t[c];n[c]=l,f&&(n.prototype[c]=function(){var v=this.__chain__;if(o||v){var _=n(this.__wrapped__),m=_.__actions__=an(this.__actions__);return m.push({func:l,args:arguments,thisArg:n}),_.__chain__=v,_}return l.apply(n,tt([this.value()],arguments))})}),n}function ng(){return k._===this&&(k._=yf),this}function Di(){}function tg(n){return n=O(n),L(function(t){return nu(t,n)})}var eg=ci(G),rg=ci(As),ig=ci(Hr);function ma(n){return _i(n)?$r(Wn(n)):Nc(n)}function sg(n){return function(t){return n==null?i:mt(n,t)}}var ug=Cu(),ag=Cu(!0);function Ni(){return[]}function Hi(){return!1}function og(){return{}}function fg(){return""}function cg(){return!0}function hg(n,t){if(n=O(n),n<1||n>jn)return[];var e=$n,r=nn(n,$n);t=x(t),n-=$n;for(var s=Wr(r,t);++e<n;)t(e);return s}function lg(n){return R(n)?G(n,Wn):dn(n)?[n]:an(qu(q(n)))}function pg(n){var t=++xf;return q(n)+t}var dg=Qe(function(n,t){return n+t},0),gg=hi("ceil"),vg=Qe(function(n,t){return n/t},1),_g=hi("floor");function mg(n){return n&&n.length?Ge(n,cn,Qr):i}function wg(n,t){return n&&n.length?Ge(n,x(t,2),Qr):i}function Pg(n){return xs(n,cn)}function Ag(n,t){return xs(n,x(t,2))}function Cg(n){return n&&n.length?Ge(n,cn,ni):i}function Ig(n,t){return n&&n.length?Ge(n,x(t,2),ni):i}var xg=Qe(function(n,t){return n*t},1),Eg=hi("round"),yg=Qe(function(n,t){return n-t},0);function Sg(n){return n&&n.length?qr(n,cn):0}function Rg(n,t){return n&&n.length?qr(n,x(t,2)):0}return a.after=Ql,a.ary=Xu,a.assign=Up,a.assignIn=fa,a.assignInWith=fr,a.assignWith=qp,a.at=Wp,a.before=Qu,a.bind=Ii,a.bindAll=Kd,a.bindKey=Vu,a.castArray=op,a.chain=Ju,a.chunk=_h,a.compact=mh,a.concat=wh,a.cond=zd,a.conforms=Jd,a.constant=bi,a.countBy=Sl,a.create=Fp,a.curry=ku,a.curryRight=ju,a.debounce=na,a.defaults=Mp,a.defaultsDeep=Bp,a.defer=Vl,a.delay=kl,a.difference=Ph,a.differenceBy=Ah,a.differenceWith=Ch,a.drop=Ih,a.dropRight=xh,a.dropRightWhile=Eh,a.dropWhile=yh,a.fill=Sh,a.filter=Ol,a.flatMap=Ll,a.flatMapDeep=Dl,a.flatMapDepth=Nl,a.flatten=Bu,a.flattenDeep=Rh,a.flattenDepth=Oh,a.flip=jl,a.flow=Zd,a.flowRight=Xd,a.fromPairs=bh,a.functions=Xp,a.functionsIn=Qp,a.groupBy=Hl,a.initial=Lh,a.intersection=Dh,a.intersectionBy=Nh,a.intersectionWith=Hh,a.invert=kp,a.invertBy=jp,a.invokeMap=Ul,a.iteratee=Ti,a.keyBy=ql,a.keys=V,a.keysIn=fn,a.map=rr,a.mapKeys=td,a.mapValues=ed,a.matches=Qd,a.matchesProperty=Vd,a.memoize=sr,a.merge=rd,a.mergeWith=ca,a.method=kd,a.methodOf=jd,a.mixin=Li,a.negate=ur,a.nthArg=tg,a.omit=id,a.omitBy=sd,a.once=np,a.orderBy=Wl,a.over=eg,a.overArgs=tp,a.overEvery=rg,a.overSome=ig,a.partial=xi,a.partialRight=ta,a.partition=Fl,a.pick=ud,a.pickBy=ha,a.property=ma,a.propertyOf=sg,a.pull=Wh,a.pullAll=Ku,a.pullAllBy=Fh,a.pullAllWith=Mh,a.pullAt=Bh,a.range=ug,a.rangeRight=ag,a.rearg=ep,a.reject=Gl,a.remove=Gh,a.rest=rp,a.reverse=Ai,a.sampleSize=zl,a.set=od,a.setWith=fd,a.shuffle=Jl,a.slice=Kh,a.sortBy=Xl,a.sortedUniq=Vh,a.sortedUniqBy=kh,a.split=Ld,a.spread=ip,a.tail=jh,a.take=nl,a.takeRight=tl,a.takeRightWhile=el,a.takeWhile=rl,a.tap=ml,a.throttle=sp,a.thru=er,a.toArray=ua,a.toPairs=la,a.toPairsIn=pa,a.toPath=lg,a.toPlainObject=oa,a.transform=cd,a.unary=up,a.union=il,a.unionBy=sl,a.unionWith=ul,a.uniq=al,a.uniqBy=ol,a.uniqWith=fl,a.unset=hd,a.unzip=Ci,a.unzipWith=zu,a.update=ld,a.updateWith=pd,a.values=Kt,a.valuesIn=dd,a.without=cl,a.words=va,a.wrap=ap,a.xor=hl,a.xorBy=ll,a.xorWith=pl,a.zip=dl,a.zipObject=gl,a.zipObjectDeep=vl,a.zipWith=_l,a.entries=la,a.entriesIn=pa,a.extend=fa,a.extendWith=fr,Li(a,a),a.add=dg,a.attempt=_a,a.camelCase=md,a.capitalize=da,a.ceil=gg,a.clamp=gd,a.clone=fp,a.cloneDeep=hp,a.cloneDeepWith=lp,a.cloneWith=cp,a.conformsTo=pp,a.deburr=ga,a.defaultTo=Yd,a.divide=vg,a.endsWith=wd,a.eq=Tn,a.escape=Pd,a.escapeRegExp=Ad,a.every=Rl,a.find=bl,a.findIndex=Fu,a.findKey=Gp,a.findLast=Tl,a.findLastIndex=Mu,a.findLastKey=Kp,a.floor=_g,a.forEach=Yu,a.forEachRight=Zu,a.forIn=zp,a.forInRight=Jp,a.forOwn=Yp,a.forOwnRight=Zp,a.get=Si,a.gt=dp,a.gte=gp,a.has=Vp,a.hasIn=Ri,a.head=Gu,a.identity=cn,a.includes=$l,a.indexOf=Th,a.inRange=vd,a.invoke=nd,a.isArguments=At,a.isArray=R,a.isArrayBuffer=vp,a.isArrayLike=on,a.isArrayLikeObject=Y,a.isBoolean=_p,a.isBuffer=ot,a.isDate=mp,a.isElement=wp,a.isEmpty=Pp,a.isEqual=Ap,a.isEqualWith=Cp,a.isError=Ei,a.isFinite=Ip,a.isFunction=Xn,a.isInteger=ea,a.isLength=ar,a.isMap=ra,a.isMatch=xp,a.isMatchWith=Ep,a.isNaN=yp,a.isNative=Sp,a.isNil=Op,a.isNull=Rp,a.isNumber=ia,a.isObject=z,a.isObjectLike=J,a.isPlainObject=de,a.isRegExp=yi,a.isSafeInteger=bp,a.isSet=sa,a.isString=or,a.isSymbol=dn,a.isTypedArray=Gt,a.isUndefined=Tp,a.isWeakMap=Lp,a.isWeakSet=Dp,a.join=$h,a.kebabCase=Cd,a.last=xn,a.lastIndexOf=Uh,a.lowerCase=Id,a.lowerFirst=xd,a.lt=Np,a.lte=Hp,a.max=mg,a.maxBy=wg,a.mean=Pg,a.meanBy=Ag,a.min=Cg,a.minBy=Ig,a.stubArray=Ni,a.stubFalse=Hi,a.stubObject=og,a.stubString=fg,a.stubTrue=cg,a.multiply=xg,a.nth=qh,a.noConflict=ng,a.noop=Di,a.now=ir,a.pad=Ed,a.padEnd=yd,a.padStart=Sd,a.parseInt=Rd,a.random=_d,a.reduce=Ml,a.reduceRight=Bl,a.repeat=Od,a.replace=bd,a.result=ad,a.round=Eg,a.runInContext=h,a.sample=Kl,a.size=Yl,a.snakeCase=Td,a.some=Zl,a.sortedIndex=zh,a.sortedIndexBy=Jh,a.sortedIndexOf=Yh,a.sortedLastIndex=Zh,a.sortedLastIndexBy=Xh,a.sortedLastIndexOf=Qh,a.startCase=Dd,a.startsWith=Nd,a.subtract=yg,a.sum=Sg,a.sumBy=Rg,a.template=Hd,a.times=hg,a.toFinite=Qn,a.toInteger=O,a.toLength=aa,a.toLower=$d,a.toNumber=En,a.toSafeInteger=$p,a.toString=q,a.toUpper=Ud,a.trim=qd,a.trimEnd=Wd,a.trimStart=Fd,a.truncate=Md,a.unescape=Bd,a.uniqueId=pg,a.upperCase=Gd,a.upperFirst=Oi,a.each=Yu,a.eachRight=Zu,a.first=Gu,Li(a,function(){var n={};return Un(a,function(t,e){W.call(a.prototype,e)||(n[e]=t)}),n}(),{chain:!1}),a.VERSION=d,wn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){a[n].placeholder=a}),wn(["drop","take"],function(n,t){N.prototype[n]=function(e){e=e===i?1:Q(O(e),0);var r=this.__filtered__&&!t?new N(this):this.clone();return r.__filtered__?r.__takeCount__=nn(e,r.__takeCount__):r.__views__.push({size:nn(e,$n),type:n+(r.__dir__<0?"Right":"")}),r},N.prototype[n+"Right"]=function(e){return this.reverse()[n](e).reverse()}}),wn(["filter","map","takeWhile"],function(n,t){var e=t+1,r=e==Bi||e==Ua;N.prototype[n]=function(s){var o=this.clone();return o.__iteratees__.push({iteratee:x(s,3),type:e}),o.__filtered__=o.__filtered__||r,o}}),wn(["head","last"],function(n,t){var e="take"+(t?"Right":"");N.prototype[n]=function(){return this[e](1).value()[0]}}),wn(["initial","tail"],function(n,t){var e="drop"+(t?"":"Right");N.prototype[n]=function(){return this.__filtered__?new N(this):this[e](1)}}),N.prototype.compact=function(){return this.filter(cn)},N.prototype.find=function(n){return this.filter(n).head()},N.prototype.findLast=function(n){return this.reverse().find(n)},N.prototype.invokeMap=L(function(n,t){return typeof n=="function"?new N(this):this.map(function(e){return oe(e,n,t)})}),N.prototype.reject=function(n){return this.filter(ur(x(n)))},N.prototype.slice=function(n,t){n=O(n);var e=this;return e.__filtered__&&(n>0||t<0)?new N(e):(n<0?e=e.takeRight(-n):n&&(e=e.drop(n)),t!==i&&(t=O(t),e=t<0?e.dropRight(-t):e.take(t-n)),e)},N.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},N.prototype.toArray=function(){return this.take($n)},Un(N.prototype,function(n,t){var e=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),s=a[r?"take"+(t=="last"?"Right":""):t],o=r||/^find/.test(t);s&&(a.prototype[t]=function(){var f=this.__wrapped__,c=r?[1]:arguments,l=f instanceof N,v=c[0],_=l||R(f),m=function(D){var H=s.apply(a,tt([D],c));return r&&P?H[0]:H};_&&e&&typeof v=="function"&&v.length!=1&&(l=_=!1);var P=this.__chain__,I=!!this.__actions__.length,E=o&&!P,b=l&&!I;if(!o&&_){f=b?f:new N(this);var y=n.apply(f,c);return y.__actions__.push({func:er,args:[m],thisArg:i}),new An(y,P)}return E&&b?n.apply(this,c):(y=this.thru(m),E?r?y.value()[0]:y.value():y)})}),wn(["pop","push","shift","sort","splice","unshift"],function(n){var t=Re[n],e=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",r=/^(?:pop|shift)$/.test(n);a.prototype[n]=function(){var s=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(R(o)?o:[],s)}return this[e](function(f){return t.apply(R(f)?f:[],s)})}}),Un(N.prototype,function(n,t){var e=a[t];if(e){var r=e.name+"";W.call(qt,r)||(qt[r]=[]),qt[r].push({name:t,func:e})}}),qt[Xe(i,ht).name]=[{name:"wrapper",func:i}],N.prototype.clone=Bf,N.prototype.reverse=Gf,N.prototype.value=Kf,a.prototype.at=wl,a.prototype.chain=Pl,a.prototype.commit=Al,a.prototype.next=Cl,a.prototype.plant=xl,a.prototype.reverse=El,a.prototype.toJSON=a.prototype.valueOf=a.prototype.value=yl,a.prototype.first=a.prototype.head,te&&(a.prototype[te]=Il),a},Ht=Af();pt?((pt.exports=Ht)._=Ht,Tr._=Ht):k._=Ht}).call(ge)})(Ui,Ui.exports);var $g=Object.defineProperty,Ug=Object.defineProperties,qg=Object.getOwnPropertyDescriptors,Ea=Object.getOwnPropertySymbols,Wg=Object.prototype.hasOwnProperty,Fg=Object.prototype.propertyIsEnumerable,ya=(A,u,i)=>u in A?$g(A,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):A[u]=i,cr=(A,u)=>{for(var i in u||(u={}))Wg.call(u,i)&&ya(A,i,u[i]);if(Ea)for(var i of Ea(u))Fg.call(u,i)&&ya(A,i,u[i]);return A},Mg=(A,u)=>Ug(A,qg(u));function ct(A,u,i){var d;const w=en.parseChainId(A);return((d=u.rpcMap)==null?void 0:d[w.reference])||`${Hg}?chainId=${w.namespace}:${w.reference}&projectId=${i}`}function It(A){return A.includes(":")?A.split(":")[1]:A}function Sa(A){return A.map(u=>`${u.split(":")[0]}:${u.split(":")[1]}`)}function Bg(A,u){const i=Object.keys(u.namespaces).filter(w=>w.includes(A));if(!i.length)return[];const d=[];return i.forEach(w=>{const T=u.namespaces[w].accounts;d.push(...T)}),d}function Gg(A={},u={}){const i=Ra(A),d=Ra(u);return Ui.exports.merge(i,d)}function Ra(A){var u,i,d,w;const T={};if(!en.isValidObject(A))return T;for(const[$,yn]of Object.entries(A)){const zt=en.isCaipNamespace($)?[$]:yn.chains,pr=yn.methods||[],xt=yn.events||[],Dn=yn.rpcMap||{},Fn=en.parseNamespaceKey($);T[Fn]=Mg(cr(cr({},T[Fn]),yn),{chains:en.mergeArrays(zt,(u=T[Fn])==null?void 0:u.chains),methods:en.mergeArrays(pr,(i=T[Fn])==null?void 0:i.methods),events:en.mergeArrays(xt,(d=T[Fn])==null?void 0:d.events),rpcMap:cr(cr({},Dn),(w=T[Fn])==null?void 0:w.rpcMap)})}return T}function Kg(A){return A.includes(":")?A.split(":")[2]:A}function zg(A){const u={};for(const[i,d]of Object.entries(A)){const w=d.methods||[],T=d.events||[],$=d.accounts||[],yn=en.isCaipNamespace(i)?[i]:d.chains?d.chains:Sa(d.accounts);u[i]={chains:yn,methods:w,events:T,accounts:$}}return u}function qi(A){return typeof A=="number"?A:A.includes("0x")?parseInt(A,16):A.includes(":")?Number(A.split(":")[1]):Number(A)}const Oa={},K=A=>Oa[A],Wi=(A,u)=>{Oa[A]=u};class Jg{constructor(u){this.name="polkadot",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}getAccounts(){const u=this.namespace.accounts;return u?u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class Yg{constructor(u){this.name="eip155",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(u){switch(u.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(u);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(u.request.method)?await this.client.request(u):this.getHttpProvider().request(u.request)}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(parseInt(u),i),this.chainId=parseInt(u),this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}createHttpProvider(u,i){const d=i||ct(`${this.name}:${u}`,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ca.HttpConnection(d,K("disableProviderPing")))}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=parseInt(It(i));u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const u=this.chainId,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}async handleSwitchChain(u){var i,d;let w=u.request.params?(i=u.request.params[0])==null?void 0:i.chainId:"0x0";w=w.startsWith("0x")?w:`0x${w}`;const T=parseInt(w,16);if(this.isChainApproved(T))this.setDefaultChain(`${T}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:u.topic,request:{method:u.request.method,params:[{chainId:w}]},chainId:(d=this.namespace.chains)==null?void 0:d[0]}),this.setDefaultChain(`${T}`);else throw new Error(`Failed to switch to chain 'eip155:${T}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(u){return this.namespace.chains.includes(`${this.name}:${u}`)}}class Zg{constructor(u){this.name="solana",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class Xg{constructor(u){this.name="cosmos",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class Qg{constructor(u){this.name="cip34",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{const d=this.getCardanoRPCUrl(i),w=It(i);u[w]=this.createHttpProvider(w,d)}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}getCardanoRPCUrl(u){const i=this.namespace.rpcMap;if(i)return i[u]}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||this.getCardanoRPCUrl(u);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class Vg{constructor(u){this.name="elrond",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class kg{constructor(u){this.name="multiversx",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class jg{constructor(u){this.name="near",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){if(this.chainId=u,!this.httpProviders[u]){const d=i||ct(`${this.name}:${u}`,this.namespace);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);this.setHttpProvider(u,d)}this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const u=this.namespace.accounts;return u?u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;u[i]=this.createHttpProvider(i,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace);return typeof d>"u"?void 0:new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}var nv=Object.defineProperty,tv=Object.defineProperties,ev=Object.getOwnPropertyDescriptors,ba=Object.getOwnPropertySymbols,rv=Object.prototype.hasOwnProperty,iv=Object.prototype.propertyIsEnumerable,Ta=(A,u,i)=>u in A?nv(A,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):A[u]=i,hr=(A,u)=>{for(var i in u||(u={}))rv.call(u,i)&&Ta(A,i,u[i]);if(ba)for(var i of ba(u))iv.call(u,i)&&Ta(A,i,u[i]);return A},Fi=(A,u)=>tv(A,ev(u));class lr{constructor(u){this.events=new Tg.default,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=u,this.logger=typeof u?.logger<"u"&&typeof u?.logger!="string"?u.logger:Aa.pino(Aa.getDefaultLoggerOptions({level:u?.logger||Ia})),this.disableProviderPing=u?.disableProviderPing||!1}static async init(u){const i=new lr(u);return await i.initialize(),i}async request(u,i){const[d,w]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(d).request({request:hr({},u),chainId:`${d}:${w}`,topic:this.session.topic})}sendAsync(u,i,d){this.request(u,d).then(w=>i(null,w)).catch(w=>i(w,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var u;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(u=this.session)==null?void 0:u.topic,reason:en.getSdkError("USER_DISCONNECTED")}),await this.cleanup()}async connect(u){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(u),await this.cleanupPendingPairings(),!u.skipPairing)return await this.pair(u.pairingTopic)}on(u,i){this.events.on(u,i)}once(u,i){this.events.once(u,i)}removeListener(u,i){this.events.removeListener(u,i)}off(u,i){this.events.off(u,i)}get isWalletConnect(){return!0}async pair(u){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:d,approval:w}=await this.client.connect({pairingTopic:u,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});d&&(this.uri=d,this.events.emit("display_uri",d)),await w().then(T=>{this.session=T,this.namespaces||(this.namespaces=zg(T.namespaces),this.persist("namespaces",this.namespaces))}).catch(T=>{if(T.message!==Pa.PROPOSAL_EXPIRY_MESSAGE)throw T;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(u,i){try{if(!this.session)return;const[d,w]=this.validateChain(u);this.getProvider(d).setDefaultChain(w,i)}catch(d){if(!/Please call connect/.test(d.message))throw d}}async cleanupPendingPairings(u={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(en.isValidArray(i)){for(const d of i)u.deletePairings?this.client.core.expirer.set(d.topic,0):await this.client.core.relayer.subscriber.unsubscribe(d.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const u=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[u]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await bg.default.init({logger:this.providerOpts.logger||Ia,relayUrl:this.providerOpts.relayUrl||Lg,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const u=[...new Set(Object.keys(this.session.namespaces).map(i=>en.parseNamespaceKey(i)))];Wi("client",this.client),Wi("events",this.events),Wi("disableProviderPing",this.disableProviderPing),u.forEach(i=>{if(!this.session)return;const d=Bg(i,this.session),w=Sa(d),T=Gg(this.namespaces,this.optionalNamespaces),$=Fi(hr({},T[i]),{accounts:d,chains:w});switch(i){case"eip155":this.rpcProviders[i]=new Yg({namespace:$});break;case"solana":this.rpcProviders[i]=new Zg({namespace:$});break;case"cosmos":this.rpcProviders[i]=new Xg({namespace:$});break;case"polkadot":this.rpcProviders[i]=new Jg({namespace:$});break;case"cip34":this.rpcProviders[i]=new Qg({namespace:$});break;case"elrond":this.rpcProviders[i]=new Vg({namespace:$});break;case"multiversx":this.rpcProviders[i]=new kg({namespace:$});break;case"near":this.rpcProviders[i]=new jg({namespace:$});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",u=>{this.events.emit("session_ping",u)}),this.client.on("session_event",u=>{const{params:i}=u,{event:d}=i;if(d.name==="accountsChanged"){const w=d.data;w&&en.isValidArray(w)&&this.events.emit("accountsChanged",w.map(Kg))}else if(d.name==="chainChanged"){const w=i.chainId,T=i.event.data,$=en.parseNamespaceKey(w),yn=qi(w)!==qi(T)?`${$}:${qi(T)}`:w;this.onChainChanged(yn)}else this.events.emit(d.name,d.data);this.events.emit("session_event",u)}),this.client.on("session_update",({topic:u,params:i})=>{var d;const{namespaces:w}=i,T=(d=this.client)==null?void 0:d.session.get(u);this.session=Fi(hr({},T),{namespaces:w}),this.onSessionUpdate(),this.events.emit("session_update",{topic:u,params:i})}),this.client.on("session_delete",async u=>{await this.cleanup(),this.events.emit("session_delete",u),this.events.emit("disconnect",Fi(hr({},en.getSdkError("USER_DISCONNECTED")),{data:u.topic}))}),this.on(kn.DEFAULT_CHAIN_CHANGED,u=>{this.onChainChanged(u,!0)})}getProvider(u){if(!this.rpcProviders[u])throw new Error(`Provider not found: ${u}`);return this.rpcProviders[u]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(u=>{var i;this.getProvider(u).updateNamespace((i=this.session)==null?void 0:i.namespaces[u])})}setNamespaces(u){const{namespaces:i,optionalNamespaces:d,sessionProperties:w}=u;i&&Object.keys(i).length&&(this.namespaces=i),d&&Object.keys(d).length&&(this.optionalNamespaces=d),this.sessionProperties=w,this.persist("namespaces",i),this.persist("optionalNamespaces",d)}validateChain(u){const[i,d]=u?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,d];if(i&&!Object.keys(this.namespaces||{}).map($=>en.parseNamespaceKey($)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&d)return[i,d];const w=en.parseNamespaceKey(Object.keys(this.namespaces)[0]),T=this.rpcProviders[w].getDefaultChain();return[w,T]}async requestAccounts(){const[u]=this.validateChain();return await this.getProvider(u).requestAccounts()}onChainChanged(u,i=!1){var d;if(!this.namespaces)return;const[w,T]=this.validateChain(u);i||this.getProvider(w).setDefaultChain(T),((d=this.namespaces[w])!=null?d:this.namespaces[`${w}:${T}`]).defaultChain=T,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",T)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(u,i){this.client.core.storage.setItem(`${xa}/${u}`,i)}async getFromStore(u){return await this.client.core.storage.getItem(`${xa}/${u}`)}}const sv=lr;exports.UniversalProvider=sv,exports.default=lr;
+}`;var b=_a(function(){return U(o,I+"return "+m).apply(i,f)});if(b.source=m,Ei(b))throw b;return b}function $d(n){return q(n).toLowerCase()}function Ud(n){return q(n).toUpperCase()}function qd(n,t,e){if(n=q(n),n&&(e||t===i))return ys(n);if(!n||!(t=pn(t)))return n;var r=On(n),s=On(t),o=Ss(r,s),f=Rs(r,s)+1;return at(r,o,f).join("")}function Wd(n,t,e){if(n=q(n),n&&(e||t===i))return n.slice(0,bs(n)+1);if(!n||!(t=pn(t)))return n;var r=On(n),s=Rs(r,On(t))+1;return at(r,0,s).join("")}function Fd(n,t,e){if(n=q(n),n&&(e||t===i))return n.replace(Er,"");if(!n||!(t=pn(t)))return n;var r=On(n),s=Ss(r,On(t));return at(r,s).join("")}function Md(n,t){var e=La,r=Da;if(z(t)){var s="separator"in t?t.separator:s;e="length"in t?O(t.length):e,r="omission"in t?pn(t.omission):r}n=q(n);var o=n.length;if(Dt(n)){var f=On(n);o=f.length}if(e>=o)return n;var c=e-Nt(r);if(c<1)return r;var l=f?at(f,0,c).join(""):n.slice(0,c);if(s===i)return l+r;if(f&&(c+=l.length-c),yi(s)){if(n.slice(c).search(s)){var v,_=l;for(s.global||(s=Br(s.source,q(Zi.exec(s))+"g")),s.lastIndex=0;v=s.exec(_);)var m=v.index;l=l.slice(0,m===i?c:m)}}else if(n.indexOf(pn(s),c)!=c){var P=l.lastIndexOf(s);P>-1&&(l=l.slice(0,P))}return l+r}function Bd(n){return n=q(n),n&&Va.test(n)?n.replace(zi,_f):n}var Gd=Mt(function(n,t,e){return n+(e?" ":"")+t.toUpperCase()}),Oi=mu("toUpperCase");function va(n,t,e){return n=q(n),t=e?i:t,t===i?lf(n)?Pf(n):ef(n):n.match(t)||[]}var _a=L(function(n,t){try{return hn(n,i,t)}catch(e){return Ei(e)?e:new S(e)}}),Kd=Yn(function(n,t){return wn(t,function(e){e=Wn(e),zn(n,e,Ii(n[e],n))}),n});function zd(n){var t=n==null?0:n.length,e=x();return n=t?G(n,function(r){if(typeof r[1]!="function")throw new Pn($);return[e(r[0]),r[1]]}):[],L(function(r){for(var s=-1;++s<t;){var o=n[s];if(hn(o[0],this,r))return hn(o[1],this,r)}})}function Jd(n){return _c(Cn(n,Dn))}function bi(n){return function(){return n}}function Yd(n,t){return n==null||n!==n?t:n}var Zd=Pu(),Xd=Pu(!0);function cn(n){return n}function Ti(n){return Qs(typeof n=="function"?n:Cn(n,Dn))}function Qd(n){return ks(Cn(n,Dn))}function Vd(n,t){return js(n,Cn(t,Dn))}var kd=L(function(n,t){return function(e){return oe(e,n,t)}}),jd=L(function(n,t){return function(e){return oe(n,e,t)}});function Li(n,t,e){var r=V(t),s=Ke(t,r);e==null&&!(z(t)&&(s.length||!r.length))&&(e=t,t=n,n=this,s=Ke(t,V(t)));var o=!(z(e)&&"chain"in e)||!!e.chain,f=Xn(n);return wn(s,function(c){var l=t[c];n[c]=l,f&&(n.prototype[c]=function(){var v=this.__chain__;if(o||v){var _=n(this.__wrapped__),m=_.__actions__=an(this.__actions__);return m.push({func:l,args:arguments,thisArg:n}),_.__chain__=v,_}return l.apply(n,tt([this.value()],arguments))})}),n}function ng(){return k._===this&&(k._=yf),this}function Di(){}function tg(n){return n=O(n),L(function(t){return nu(t,n)})}var eg=ci(G),rg=ci(As),ig=ci(Hr);function ma(n){return _i(n)?$r(Wn(n)):Nc(n)}function sg(n){return function(t){return n==null?i:mt(n,t)}}var ug=Cu(),ag=Cu(!0);function Ni(){return[]}function Hi(){return!1}function og(){return{}}function fg(){return""}function cg(){return!0}function hg(n,t){if(n=O(n),n<1||n>jn)return[];var e=$n,r=nn(n,$n);t=x(t),n-=$n;for(var s=Wr(r,t);++e<n;)t(e);return s}function lg(n){return R(n)?G(n,Wn):dn(n)?[n]:an(qu(q(n)))}function pg(n){var t=++xf;return q(n)+t}var dg=Qe(function(n,t){return n+t},0),gg=hi("ceil"),vg=Qe(function(n,t){return n/t},1),_g=hi("floor");function mg(n){return n&&n.length?Ge(n,cn,Qr):i}function wg(n,t){return n&&n.length?Ge(n,x(t,2),Qr):i}function Pg(n){return xs(n,cn)}function Ag(n,t){return xs(n,x(t,2))}function Cg(n){return n&&n.length?Ge(n,cn,ni):i}function Ig(n,t){return n&&n.length?Ge(n,x(t,2),ni):i}var xg=Qe(function(n,t){return n*t},1),Eg=hi("round"),yg=Qe(function(n,t){return n-t},0);function Sg(n){return n&&n.length?qr(n,cn):0}function Rg(n,t){return n&&n.length?qr(n,x(t,2)):0}return a.after=Ql,a.ary=Xu,a.assign=Up,a.assignIn=fa,a.assignInWith=fr,a.assignWith=qp,a.at=Wp,a.before=Qu,a.bind=Ii,a.bindAll=Kd,a.bindKey=Vu,a.castArray=op,a.chain=Ju,a.chunk=_h,a.compact=mh,a.concat=wh,a.cond=zd,a.conforms=Jd,a.constant=bi,a.countBy=Sl,a.create=Fp,a.curry=ku,a.curryRight=ju,a.debounce=na,a.defaults=Mp,a.defaultsDeep=Bp,a.defer=Vl,a.delay=kl,a.difference=Ph,a.differenceBy=Ah,a.differenceWith=Ch,a.drop=Ih,a.dropRight=xh,a.dropRightWhile=Eh,a.dropWhile=yh,a.fill=Sh,a.filter=Ol,a.flatMap=Ll,a.flatMapDeep=Dl,a.flatMapDepth=Nl,a.flatten=Bu,a.flattenDeep=Rh,a.flattenDepth=Oh,a.flip=jl,a.flow=Zd,a.flowRight=Xd,a.fromPairs=bh,a.functions=Xp,a.functionsIn=Qp,a.groupBy=Hl,a.initial=Lh,a.intersection=Dh,a.intersectionBy=Nh,a.intersectionWith=Hh,a.invert=kp,a.invertBy=jp,a.invokeMap=Ul,a.iteratee=Ti,a.keyBy=ql,a.keys=V,a.keysIn=fn,a.map=rr,a.mapKeys=td,a.mapValues=ed,a.matches=Qd,a.matchesProperty=Vd,a.memoize=sr,a.merge=rd,a.mergeWith=ca,a.method=kd,a.methodOf=jd,a.mixin=Li,a.negate=ur,a.nthArg=tg,a.omit=id,a.omitBy=sd,a.once=np,a.orderBy=Wl,a.over=eg,a.overArgs=tp,a.overEvery=rg,a.overSome=ig,a.partial=xi,a.partialRight=ta,a.partition=Fl,a.pick=ud,a.pickBy=ha,a.property=ma,a.propertyOf=sg,a.pull=Wh,a.pullAll=Ku,a.pullAllBy=Fh,a.pullAllWith=Mh,a.pullAt=Bh,a.range=ug,a.rangeRight=ag,a.rearg=ep,a.reject=Gl,a.remove=Gh,a.rest=rp,a.reverse=Ai,a.sampleSize=zl,a.set=od,a.setWith=fd,a.shuffle=Jl,a.slice=Kh,a.sortBy=Xl,a.sortedUniq=Vh,a.sortedUniqBy=kh,a.split=Ld,a.spread=ip,a.tail=jh,a.take=nl,a.takeRight=tl,a.takeRightWhile=el,a.takeWhile=rl,a.tap=ml,a.throttle=sp,a.thru=er,a.toArray=ua,a.toPairs=la,a.toPairsIn=pa,a.toPath=lg,a.toPlainObject=oa,a.transform=cd,a.unary=up,a.union=il,a.unionBy=sl,a.unionWith=ul,a.uniq=al,a.uniqBy=ol,a.uniqWith=fl,a.unset=hd,a.unzip=Ci,a.unzipWith=zu,a.update=ld,a.updateWith=pd,a.values=Kt,a.valuesIn=dd,a.without=cl,a.words=va,a.wrap=ap,a.xor=hl,a.xorBy=ll,a.xorWith=pl,a.zip=dl,a.zipObject=gl,a.zipObjectDeep=vl,a.zipWith=_l,a.entries=la,a.entriesIn=pa,a.extend=fa,a.extendWith=fr,Li(a,a),a.add=dg,a.attempt=_a,a.camelCase=md,a.capitalize=da,a.ceil=gg,a.clamp=gd,a.clone=fp,a.cloneDeep=hp,a.cloneDeepWith=lp,a.cloneWith=cp,a.conformsTo=pp,a.deburr=ga,a.defaultTo=Yd,a.divide=vg,a.endsWith=wd,a.eq=Tn,a.escape=Pd,a.escapeRegExp=Ad,a.every=Rl,a.find=bl,a.findIndex=Fu,a.findKey=Gp,a.findLast=Tl,a.findLastIndex=Mu,a.findLastKey=Kp,a.floor=_g,a.forEach=Yu,a.forEachRight=Zu,a.forIn=zp,a.forInRight=Jp,a.forOwn=Yp,a.forOwnRight=Zp,a.get=Si,a.gt=dp,a.gte=gp,a.has=Vp,a.hasIn=Ri,a.head=Gu,a.identity=cn,a.includes=$l,a.indexOf=Th,a.inRange=vd,a.invoke=nd,a.isArguments=At,a.isArray=R,a.isArrayBuffer=vp,a.isArrayLike=on,a.isArrayLikeObject=Y,a.isBoolean=_p,a.isBuffer=ot,a.isDate=mp,a.isElement=wp,a.isEmpty=Pp,a.isEqual=Ap,a.isEqualWith=Cp,a.isError=Ei,a.isFinite=Ip,a.isFunction=Xn,a.isInteger=ea,a.isLength=ar,a.isMap=ra,a.isMatch=xp,a.isMatchWith=Ep,a.isNaN=yp,a.isNative=Sp,a.isNil=Op,a.isNull=Rp,a.isNumber=ia,a.isObject=z,a.isObjectLike=J,a.isPlainObject=de,a.isRegExp=yi,a.isSafeInteger=bp,a.isSet=sa,a.isString=or,a.isSymbol=dn,a.isTypedArray=Gt,a.isUndefined=Tp,a.isWeakMap=Lp,a.isWeakSet=Dp,a.join=$h,a.kebabCase=Cd,a.last=xn,a.lastIndexOf=Uh,a.lowerCase=Id,a.lowerFirst=xd,a.lt=Np,a.lte=Hp,a.max=mg,a.maxBy=wg,a.mean=Pg,a.meanBy=Ag,a.min=Cg,a.minBy=Ig,a.stubArray=Ni,a.stubFalse=Hi,a.stubObject=og,a.stubString=fg,a.stubTrue=cg,a.multiply=xg,a.nth=qh,a.noConflict=ng,a.noop=Di,a.now=ir,a.pad=Ed,a.padEnd=yd,a.padStart=Sd,a.parseInt=Rd,a.random=_d,a.reduce=Ml,a.reduceRight=Bl,a.repeat=Od,a.replace=bd,a.result=ad,a.round=Eg,a.runInContext=h,a.sample=Kl,a.size=Yl,a.snakeCase=Td,a.some=Zl,a.sortedIndex=zh,a.sortedIndexBy=Jh,a.sortedIndexOf=Yh,a.sortedLastIndex=Zh,a.sortedLastIndexBy=Xh,a.sortedLastIndexOf=Qh,a.startCase=Dd,a.startsWith=Nd,a.subtract=yg,a.sum=Sg,a.sumBy=Rg,a.template=Hd,a.times=hg,a.toFinite=Qn,a.toInteger=O,a.toLength=aa,a.toLower=$d,a.toNumber=En,a.toSafeInteger=$p,a.toString=q,a.toUpper=Ud,a.trim=qd,a.trimEnd=Wd,a.trimStart=Fd,a.truncate=Md,a.unescape=Bd,a.uniqueId=pg,a.upperCase=Gd,a.upperFirst=Oi,a.each=Yu,a.eachRight=Zu,a.first=Gu,Li(a,function(){var n={};return Un(a,function(t,e){W.call(a.prototype,e)||(n[e]=t)}),n}(),{chain:!1}),a.VERSION=d,wn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){a[n].placeholder=a}),wn(["drop","take"],function(n,t){N.prototype[n]=function(e){e=e===i?1:Q(O(e),0);var r=this.__filtered__&&!t?new N(this):this.clone();return r.__filtered__?r.__takeCount__=nn(e,r.__takeCount__):r.__views__.push({size:nn(e,$n),type:n+(r.__dir__<0?"Right":"")}),r},N.prototype[n+"Right"]=function(e){return this.reverse()[n](e).reverse()}}),wn(["filter","map","takeWhile"],function(n,t){var e=t+1,r=e==Bi||e==Ua;N.prototype[n]=function(s){var o=this.clone();return o.__iteratees__.push({iteratee:x(s,3),type:e}),o.__filtered__=o.__filtered__||r,o}}),wn(["head","last"],function(n,t){var e="take"+(t?"Right":"");N.prototype[n]=function(){return this[e](1).value()[0]}}),wn(["initial","tail"],function(n,t){var e="drop"+(t?"":"Right");N.prototype[n]=function(){return this.__filtered__?new N(this):this[e](1)}}),N.prototype.compact=function(){return this.filter(cn)},N.prototype.find=function(n){return this.filter(n).head()},N.prototype.findLast=function(n){return this.reverse().find(n)},N.prototype.invokeMap=L(function(n,t){return typeof n=="function"?new N(this):this.map(function(e){return oe(e,n,t)})}),N.prototype.reject=function(n){return this.filter(ur(x(n)))},N.prototype.slice=function(n,t){n=O(n);var e=this;return e.__filtered__&&(n>0||t<0)?new N(e):(n<0?e=e.takeRight(-n):n&&(e=e.drop(n)),t!==i&&(t=O(t),e=t<0?e.dropRight(-t):e.take(t-n)),e)},N.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},N.prototype.toArray=function(){return this.take($n)},Un(N.prototype,function(n,t){var e=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),s=a[r?"take"+(t=="last"?"Right":""):t],o=r||/^find/.test(t);s&&(a.prototype[t]=function(){var f=this.__wrapped__,c=r?[1]:arguments,l=f instanceof N,v=c[0],_=l||R(f),m=function(D){var H=s.apply(a,tt([D],c));return r&&P?H[0]:H};_&&e&&typeof v=="function"&&v.length!=1&&(l=_=!1);var P=this.__chain__,I=!!this.__actions__.length,E=o&&!P,b=l&&!I;if(!o&&_){f=b?f:new N(this);var y=n.apply(f,c);return y.__actions__.push({func:er,args:[m],thisArg:i}),new An(y,P)}return E&&b?n.apply(this,c):(y=this.thru(m),E?r?y.value()[0]:y.value():y)})}),wn(["pop","push","shift","sort","splice","unshift"],function(n){var t=Re[n],e=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",r=/^(?:pop|shift)$/.test(n);a.prototype[n]=function(){var s=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(R(o)?o:[],s)}return this[e](function(f){return t.apply(R(f)?f:[],s)})}}),Un(N.prototype,function(n,t){var e=a[t];if(e){var r=e.name+"";W.call(qt,r)||(qt[r]=[]),qt[r].push({name:t,func:e})}}),qt[Xe(i,ht).name]=[{name:"wrapper",func:i}],N.prototype.clone=Bf,N.prototype.reverse=Gf,N.prototype.value=Kf,a.prototype.at=wl,a.prototype.chain=Pl,a.prototype.commit=Al,a.prototype.next=Cl,a.prototype.plant=xl,a.prototype.reverse=El,a.prototype.toJSON=a.prototype.valueOf=a.prototype.value=yl,a.prototype.first=a.prototype.head,te&&(a.prototype[te]=Il),a},Ht=Af();pt?((pt.exports=Ht)._=Ht,Tr._=Ht):k._=Ht}).call(ge)})(Ui,Ui.exports);var $g=Object.defineProperty,Ug=Object.defineProperties,qg=Object.getOwnPropertyDescriptors,Ea=Object.getOwnPropertySymbols,Wg=Object.prototype.hasOwnProperty,Fg=Object.prototype.propertyIsEnumerable,ya=(A,u,i)=>u in A?$g(A,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):A[u]=i,cr=(A,u)=>{for(var i in u||(u={}))Wg.call(u,i)&&ya(A,i,u[i]);if(Ea)for(var i of Ea(u))Fg.call(u,i)&&ya(A,i,u[i]);return A},Mg=(A,u)=>Ug(A,qg(u));function ct(A,u,i){var d;const w=en.parseChainId(A);return((d=u.rpcMap)==null?void 0:d[w.reference])||`${Hg}?chainId=${w.namespace}:${w.reference}&projectId=${i}`}function It(A){return A.includes(":")?A.split(":")[1]:A}function Sa(A){return A.map(u=>`${u.split(":")[0]}:${u.split(":")[1]}`)}function Bg(A,u){const i=Object.keys(u.namespaces).filter(w=>w.includes(A));if(!i.length)return[];const d=[];return i.forEach(w=>{const T=u.namespaces[w].accounts;d.push(...T)}),d}function Gg(A={},u={}){const i=Ra(A),d=Ra(u);return Ui.exports.merge(i,d)}function Ra(A){var u,i,d,w;const T={};if(!en.isValidObject(A))return T;for(const[$,yn]of Object.entries(A)){const zt=en.isCaipNamespace($)?[$]:yn.chains,pr=yn.methods||[],xt=yn.events||[],Dn=yn.rpcMap||{},Fn=en.parseNamespaceKey($);T[Fn]=Mg(cr(cr({},T[Fn]),yn),{chains:en.mergeArrays(zt,(u=T[Fn])==null?void 0:u.chains),methods:en.mergeArrays(pr,(i=T[Fn])==null?void 0:i.methods),events:en.mergeArrays(xt,(d=T[Fn])==null?void 0:d.events),rpcMap:cr(cr({},Dn),(w=T[Fn])==null?void 0:w.rpcMap)})}return T}function Kg(A){return A.includes(":")?A.split(":")[2]:A}function zg(A){const u={};for(const[i,d]of Object.entries(A)){const w=d.methods||[],T=d.events||[],$=d.accounts||[],yn=en.isCaipNamespace(i)?[i]:d.chains?d.chains:Sa(d.accounts);u[i]={chains:yn,methods:w,events:T,accounts:$}}return u}function qi(A){return typeof A=="number"?A:A.includes("0x")?parseInt(A,16):A.includes(":")?Number(A.split(":")[1]):Number(A)}const Oa={},K=A=>Oa[A],Wi=(A,u)=>{Oa[A]=u};class Jg{constructor(u){this.name="polkadot",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}getAccounts(){const u=this.namespace.accounts;return u?u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class Yg{constructor(u){this.name="eip155",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(u){switch(u.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(u);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(u.request.method)?await this.client.request(u):this.getHttpProvider().request(u.request)}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(parseInt(u),i),this.chainId=parseInt(u),this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}createHttpProvider(u,i){const d=i||ct(`${this.name}:${u}`,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ca.HttpConnection(d,K("disableProviderPing")))}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=parseInt(It(i));u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const u=this.chainId,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}async handleSwitchChain(u){var i,d;let w=u.request.params?(i=u.request.params[0])==null?void 0:i.chainId:"0x0";w=w.startsWith("0x")?w:`0x${w}`;const T=parseInt(w,16);if(this.isChainApproved(T))this.setDefaultChain(`${T}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:u.topic,request:{method:u.request.method,params:[{chainId:w}]},chainId:(d=this.namespace.chains)==null?void 0:d[0]}),this.setDefaultChain(`${T}`);else throw new Error(`Failed to switch to chain 'eip155:${T}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(u){return this.namespace.chains.includes(`${this.name}:${u}`)}}class Zg{constructor(u){this.name="solana",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class Xg{constructor(u){this.name="cosmos",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class Qg{constructor(u){this.name="cip34",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{const d=this.getCardanoRPCUrl(i),w=It(i);u[w]=this.createHttpProvider(w,d)}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}getCardanoRPCUrl(u){const i=this.namespace.rpcMap;if(i)return i[u]}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||this.getCardanoRPCUrl(u);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class Vg{constructor(u){this.name="elrond",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class kg{constructor(u){this.name="multiversx",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){this.httpProviders[u]||this.setHttpProvider(u,i),this.chainId=u,this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${u}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}getAccounts(){const u=this.namespace.accounts;return u?[...new Set(u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;const w=It(i);u[w]=this.createHttpProvider(w,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace,this.client.core.projectId);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);return new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}class jg{constructor(u){this.name="near",this.namespace=u.namespace,this.events=K("events"),this.client=K("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(u){this.namespace=Object.assign(this.namespace,u)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const u=this.namespace.chains[0];if(!u)throw new Error("ChainId not found");return u.split(":")[1]}request(u){return this.namespace.methods.includes(u.request.method)?this.client.request(u):this.getHttpProvider().request(u.request)}setDefaultChain(u,i){if(this.chainId=u,!this.httpProviders[u]){const d=i||ct(`${this.name}:${u}`,this.namespace);if(!d)throw new Error(`No RPC url provided for chainId: ${u}`);this.setHttpProvider(u,d)}this.events.emit(kn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const u=this.namespace.accounts;return u?u.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const u={};return this.namespace.chains.forEach(i=>{var d;u[i]=this.createHttpProvider(i,(d=this.namespace.rpcMap)==null?void 0:d[i])}),u}getHttpProvider(){const u=`${this.name}:${this.chainId}`,i=this.httpProviders[u];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${u} not found`);return i}setHttpProvider(u,i){const d=this.createHttpProvider(u,i);d&&(this.httpProviders[u]=d)}createHttpProvider(u,i){const d=i||ct(u,this.namespace);return typeof d>"u"?void 0:new ft.JsonRpcProvider(new Ct.default(d,K("disableProviderPing")))}}var nv=Object.defineProperty,tv=Object.defineProperties,ev=Object.getOwnPropertyDescriptors,ba=Object.getOwnPropertySymbols,rv=Object.prototype.hasOwnProperty,iv=Object.prototype.propertyIsEnumerable,Ta=(A,u,i)=>u in A?nv(A,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):A[u]=i,hr=(A,u)=>{for(var i in u||(u={}))rv.call(u,i)&&Ta(A,i,u[i]);if(ba)for(var i of ba(u))iv.call(u,i)&&Ta(A,i,u[i]);return A},Fi=(A,u)=>tv(A,ev(u));class lr{constructor(u){this.events=new Tg.default,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=u,this.logger=typeof u?.logger<"u"&&typeof u?.logger!="string"?u.logger:Aa.pino(Aa.getDefaultLoggerOptions({level:u?.logger||Ia})),this.disableProviderPing=u?.disableProviderPing||!1}static async init(u){const i=new lr(u);return await i.initialize(),i}async request(u,i){const[d,w]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(d).request({request:hr({},u),chainId:`${d}:${w}`,topic:this.session.topic})}sendAsync(u,i,d){this.request(u,d).then(w=>i(null,w)).catch(w=>i(w,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var u;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(u=this.session)==null?void 0:u.topic,reason:en.getSdkError("USER_DISCONNECTED")}),await this.cleanup()}async connect(u){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(u),await this.cleanupPendingPairings(),!u.skipPairing)return await this.pair(u.pairingTopic)}on(u,i){this.events.on(u,i)}once(u,i){this.events.once(u,i)}removeListener(u,i){this.events.removeListener(u,i)}off(u,i){this.events.off(u,i)}get isWalletConnect(){return!0}async pair(u){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:d,approval:w}=await this.client.connect({pairingTopic:u,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});d&&(this.uri=d,this.events.emit("display_uri",d)),await w().then(T=>{this.session=T,this.namespaces||(this.namespaces=zg(T.namespaces),this.persist("namespaces",this.namespaces))}).catch(T=>{if(T.message!==Pa.PROPOSAL_EXPIRY_MESSAGE)throw T;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(u,i){try{if(!this.session)return;const[d,w]=this.validateChain(u);this.getProvider(d).setDefaultChain(w,i)}catch(d){if(!/Please call connect/.test(d.message))throw d}}async cleanupPendingPairings(u={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(en.isValidArray(i)){for(const d of i)u.deletePairings?this.client.core.expirer.set(d.topic,0):await this.client.core.relayer.subscriber.unsubscribe(d.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const u=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[u]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await (bg.default.init || bg.default.default.init)({logger:this.providerOpts.logger||Ia,relayUrl:this.providerOpts.relayUrl||Lg,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const u=[...new Set(Object.keys(this.session.namespaces).map(i=>en.parseNamespaceKey(i)))];Wi("client",this.client),Wi("events",this.events),Wi("disableProviderPing",this.disableProviderPing),u.forEach(i=>{if(!this.session)return;const d=Bg(i,this.session),w=Sa(d),T=Gg(this.namespaces,this.optionalNamespaces),$=Fi(hr({},T[i]),{accounts:d,chains:w});switch(i){case"eip155":this.rpcProviders[i]=new Yg({namespace:$});break;case"solana":this.rpcProviders[i]=new Zg({namespace:$});break;case"cosmos":this.rpcProviders[i]=new Xg({namespace:$});break;case"polkadot":this.rpcProviders[i]=new Jg({namespace:$});break;case"cip34":this.rpcProviders[i]=new Qg({namespace:$});break;case"elrond":this.rpcProviders[i]=new Vg({namespace:$});break;case"multiversx":this.rpcProviders[i]=new kg({namespace:$});break;case"near":this.rpcProviders[i]=new jg({namespace:$});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",u=>{this.events.emit("session_ping",u)}),this.client.on("session_event",u=>{const{params:i}=u,{event:d}=i;if(d.name==="accountsChanged"){const w=d.data;w&&en.isValidArray(w)&&this.events.emit("accountsChanged",w.map(Kg))}else if(d.name==="chainChanged"){const w=i.chainId,T=i.event.data,$=en.parseNamespaceKey(w),yn=qi(w)!==qi(T)?`${$}:${qi(T)}`:w;this.onChainChanged(yn)}else this.events.emit(d.name,d.data);this.events.emit("session_event",u)}),this.client.on("session_update",({topic:u,params:i})=>{var d;const{namespaces:w}=i,T=(d=this.client)==null?void 0:d.session.get(u);this.session=Fi(hr({},T),{namespaces:w}),this.onSessionUpdate(),this.events.emit("session_update",{topic:u,params:i})}),this.client.on("session_delete",async u=>{await this.cleanup(),this.events.emit("session_delete",u),this.events.emit("disconnect",Fi(hr({},en.getSdkError("USER_DISCONNECTED")),{data:u.topic}))}),this.on(kn.DEFAULT_CHAIN_CHANGED,u=>{this.onChainChanged(u,!0)})}getProvider(u){if(!this.rpcProviders[u])throw new Error(`Provider not found: ${u}`);return this.rpcProviders[u]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(u=>{var i;this.getProvider(u).updateNamespace((i=this.session)==null?void 0:i.namespaces[u])})}setNamespaces(u){const{namespaces:i,optionalNamespaces:d,sessionProperties:w}=u;i&&Object.keys(i).length&&(this.namespaces=i),d&&Object.keys(d).length&&(this.optionalNamespaces=d),this.sessionProperties=w,this.persist("namespaces",i),this.persist("optionalNamespaces",d)}validateChain(u){const[i,d]=u?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,d];if(i&&!Object.keys(this.namespaces||{}).map($=>en.parseNamespaceKey($)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&d)return[i,d];const w=en.parseNamespaceKey(Object.keys(this.namespaces)[0]),T=this.rpcProviders[w].getDefaultChain();return[w,T]}async requestAccounts(){const[u]=this.validateChain();return await this.getProvider(u).requestAccounts()}onChainChanged(u,i=!1){var d;if(!this.namespaces)return;const[w,T]=this.validateChain(u);i||this.getProvider(w).setDefaultChain(T),((d=this.namespaces[w])!=null?d:this.namespaces[`${w}:${T}`]).defaultChain=T,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",T)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(u,i){this.client.core.storage.setItem(`${xa}/${u}`,i)}async getFromStore(u){return await this.client.core.storage.getItem(`${xa}/${u}`)}}const sv=lr;exports.UniversalProvider=sv,exports.default=lr;
 //# sourceMappingURL=index.cjs.js.map
